<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°„ë‹¨í•œ SurveyDataManager í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .log {
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        .primary { background-color: #007acc; color: white; }
        .secondary { background-color: #6c757d; color: white; }
        .success { background-color: #28a745; color: white; }
        .danger { background-color: #dc3545; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª ê°„ë‹¨í•œ SurveyDataManager í…ŒìŠ¤íŠ¸</h1>
        
        <div>
            <button class="primary" onclick="testBasicLoading()">ê¸°ë³¸ ë¡œë”© í…ŒìŠ¤íŠ¸</button>
            <button class="secondary" onclick="testClassDefinition()">í´ë˜ìŠ¤ ì •ì˜ í™•ì¸</button>
            <button class="success" onclick="testInstanceCreation()">ì¸ìŠ¤í„´ìŠ¤ ìƒì„± í…ŒìŠ¤íŠ¸</button>
            <button class="danger" onclick="clearLog()">ë¡œê·¸ ì§€ìš°ê¸°</button>
        </div>
        
        <div id="log" class="log"></div>
    </div>

    <!-- ë””ë²„ê¹…ì„ ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
        const logElement = document.getElementById('log');
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logMessage = `[${timestamp}] ${message}\n`;
            logElement.textContent += logMessage;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(message);
        }
        
        function clearLog() {
            logElement.textContent = '';
        }
        
        // ì „ì—­ ì˜¤ë¥˜ í•¸ë“¤ëŸ¬
        window.addEventListener('error', (e) => {
            log(`âŒ ì˜¤ë¥˜: ${e.message} (${e.filename}:${e.lineno})`);
        });
        
        window.addEventListener('unhandledrejection', (e) => {
            log(`âŒ Promise ê±°ë¶€: ${e.reason}`);
        });
        
        // í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ë“¤
        function testBasicLoading() {
            log('ğŸ§ª === ê¸°ë³¸ ë¡œë”© í…ŒìŠ¤íŠ¸ ===');
            log(`window.SurveyDataManager: ${typeof window.SurveyDataManager}`);
            log(`window.surveyDataManager: ${typeof window.surveyDataManager}`);
            
            if (window.surveyDataManager) {
                log('âœ… surveyDataManager ì¸ìŠ¤í„´ìŠ¤ ì¡´ì¬');
                try {
                    const status = window.surveyDataManager.getSystemStatus();
                    log('âœ… getSystemStatus() í˜¸ì¶œ ì„±ê³µ');
                    log(`í…Œë¸”ë¦¿ ID: ${status.tabletId}`);
                } catch (error) {
                    log(`âŒ getSystemStatus() í˜¸ì¶œ ì‹¤íŒ¨: ${error.message}`);
                }
            } else {
                log('âŒ surveyDataManager ì¸ìŠ¤í„´ìŠ¤ ì—†ìŒ');
            }
        }
        
        function testClassDefinition() {
            log('ğŸ§ª === í´ë˜ìŠ¤ ì •ì˜ í™•ì¸ ===');
            
            try {
                log(`SurveyDataManager íƒ€ì…: ${typeof SurveyDataManager}`);
                if (typeof SurveyDataManager === 'function') {
                    log('âœ… SurveyDataManager í´ë˜ìŠ¤ ì •ì˜ë¨');
                    
                    // í´ë˜ìŠ¤ ë©”ì„œë“œ í™•ì¸
                    log(`getInstance ë©”ì„œë“œ: ${typeof SurveyDataManager.getInstance}`);
                    
                    if (SurveyDataManager.prototype) {
                        const methods = Object.getOwnPropertyNames(SurveyDataManager.prototype);
                        log(`í”„ë¡œí† íƒ€ì… ë©”ì„œë“œë“¤: ${methods.join(', ')}`);
                    }
                } else {
                    log('âŒ SurveyDataManager í´ë˜ìŠ¤ ì •ì˜ë˜ì§€ ì•ŠìŒ');
                }
            } catch (error) {
                log(`âŒ í´ë˜ìŠ¤ í™•ì¸ ì¤‘ ì˜¤ë¥˜: ${error.message}`);
            }
        }
        
        function testInstanceCreation() {
            log('ğŸ§ª === ì¸ìŠ¤í„´ìŠ¤ ìƒì„± í…ŒìŠ¤íŠ¸ ===');
            
            try {
                if (typeof SurveyDataManager !== 'undefined') {
                    log('SurveyDataManager í´ë˜ìŠ¤ í™•ì¸ë¨, ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì‹œë„...');
                    const instance = SurveyDataManager.getInstance();
                    log(`ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ê²°ê³¼: ${typeof instance}`);
                    
                    if (instance) {
                        log('âœ… ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì„±ê³µ');
                        
                        // ë©”ì„œë“œ ì¡´ì¬ í™•ì¸
                        const methods = ['saveSurveyResponse', 'saveRating', 'getSystemStatus', 'getCurrentData'];
                        methods.forEach(method => {
                            log(`${method}: ${typeof instance[method]}`);
                        });
                    } else {
                        log('âŒ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì‹¤íŒ¨ (null ë°˜í™˜)');
                    }
                } else {
                    log('âŒ SurveyDataManager í´ë˜ìŠ¤ê°€ ì •ì˜ë˜ì§€ ì•ŠìŒ');
                }
            } catch (error) {
                log(`âŒ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì¤‘ ì˜¤ë¥˜: ${error.message}`);
                log(`ìŠ¤íƒ: ${error.stack}`);
            }
        }
        
        // ì´ˆê¸° ë¡œë”© ìƒíƒœ í™•ì¸
        log('ğŸš€ ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë“œë¨');
        log('ğŸ“¦ ìŠ¤í¬ë¦½íŠ¸ ë¡œë”© ì „ ìƒíƒœ í™•ì¸...');
        testBasicLoading();
    </script>

    <!-- SurveyDataManager ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ -->
    <script>
        log('ğŸ“¦ survey-data-manager.js ë¡œë“œ ì‹œì‘...');
    </script>
    <script src="survey-data-manager.js" 
            onload="log('âœ… survey-data-manager.js ë¡œë“œ ì™„ë£Œ'); setTimeout(() => { log('=== ë¡œë“œ ì™„ë£Œ í›„ ìƒíƒœ ==='); testBasicLoading(); }, 100);" 
            onerror="log('âŒ survey-data-manager.js ë¡œë“œ ì‹¤íŒ¨');"></script>
    
    <script>
        // ì¶”ê°€ í™•ì¸
        setTimeout(() => {
            log('=== ìµœì¢… í™•ì¸ (1ì´ˆ í›„) ===');
            testBasicLoading();
        }, 1000);
    </script>
</body>
</html>
