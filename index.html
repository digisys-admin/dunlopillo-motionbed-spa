<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover, minimal-ui" />
    <meta charset="utf-8" />
    
    <!-- ëª¨ë°”ì¼ ìµœì í™” ë©”íƒ€ íƒœê·¸ -->
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- PWA ë§¤ë‹ˆí˜ìŠ¤íŠ¸ -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1e40af">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-fullscreen">
    <meta name="apple-mobile-web-app-title" content="ë˜ë¡­í•„ë¡œ SPA">
    
    <!-- í°íŠ¸ ìµœì í™”: Pretendard í°íŠ¸ (ì•ˆì •ì ì¸ CDN ê²½ë¡œ) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preload" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/variable/pretendardvariable.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/variable/pretendardvariable.css"></noscript>
    
    <!-- ğŸš€ í•µì‹¬ ì´ë¯¸ì§€ ë„¤ì´í‹°ë¸Œ í”„ë¦¬ë¡œë”© (ê°€ì¥ ë¹ ë¥¸ ë°©ë²•) -->
    <link rel="preload" as="image" href="assets/pics/dunlopillo_logo.png">
    <link rel="preload" as="image" href="assets/pics/p2_bed.png">
    <link rel="preload" as="image" href="assets/pics/p3_pic1.png">
    <link rel="preload" as="image" href="assets/pics/p4_pic1.png">
    <link rel="preload" as="image" href="assets/pics/home-icon.png">
    
    <!-- ë©”ì¸ ìŠ¤íƒ€ì¼ì‹œíŠ¸ -->
    <link rel="stylesheet" href="styles.css" />
    
    <!-- í”„ë¦¬ë¡œë”© ìŠ¤í¬ë¦° ìŠ¤íƒ€ì¼ -->
    <style>
      .preloading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        transition: opacity 0.5s ease-out;
      }

      .preloading-overlay.fade-out {
        opacity: 0;
        pointer-events: none;
      }

      .preloading-container {
        text-align: center;
        color: white;
        font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
      }

      .preloading-logo {
        width: 200px;
        height: 45px;
        margin: 0 auto 40px;
        background: white;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: #1e40af;
        font-size: 18px;
      }

      .preloading-progress {
        width: 400px;
        height: 8px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 4px;
        overflow: hidden;
        margin: 0 auto 20px;
        position: relative;
      }

      .preloading-fill {
        height: 100%;
        background: linear-gradient(90deg, #60a5fa, #93c5fd);
        border-radius: 4px;
        transition: width 0.3s ease-out;
        width: 0%;
        position: relative;
      }

      .preloading-fill::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
        animation: shimmer 1.5s infinite;
      }

      @keyframes shimmer {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
      }

      .preloading-text {
        font-size: 18px;
        margin-bottom: 10px;
        font-weight: 500;
      }

      .preloading-details {
        font-size: 14px;
        opacity: 0.8;
        margin-bottom: 30px;
      }

      .preloading-stats {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        max-width: 400px;
        margin: 0 auto;
      }

      .stat-item {
        background: rgba(255, 255, 255, 0.1);
        padding: 15px;
        border-radius: 8px;
        backdrop-filter: blur(10px);
      }

      .stat-number {
        font-size: 24px;
        font-weight: bold;
        color: #60a5fa;
      }

      .stat-label {
        font-size: 12px;
        opacity: 0.8;
        margin-top: 5px;
      }

      /* ë°˜ì‘í˜• ë””ìì¸ */
      @media (max-width: 768px) {
        .preloading-progress {
          width: 300px;
        }
        
        .preloading-stats {
          grid-template-columns: 1fr;
          gap: 10px;
        }
      }
      
      /* ğŸš€ ì´ë¯¸ì§€ ë¡œë”© ìµœì í™” CSS */
      img {
        image-rendering: -webkit-optimize-contrast; /* ë Œë”ë§ ìµœì í™” */
        image-rendering: crisp-edges; /* ì„ ëª…ë„ ìš°ì„  */
        transform: translateZ(0); /* í•˜ë“œì›¨ì–´ ê°€ì† */
        will-change: transform; /* GPU ë ˆì´ì–´ ìƒì„± */
      }
      
      /* ì´ë¯¸ì§€ ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ ë¶€ë“œëŸ½ê²Œ */
      .screen img {
        transition: opacity 0.1s ease-out; /* ë¹ ë¥¸ í˜ì´ë“œì¸ */
      }
      
      /* ë¸Œë¼ìš°ì € ìºì‹œ ìµœëŒ€í™” */
      .preloaded-image {
        position: absolute;
        left: -9999px;
        top: -9999px;
        opacity: 0;
        pointer-events: none;
        z-index: -1;
      }
    </style>
    
    <title>Dunlopillo SPA</title>
    
    <!-- URL ê²½ë¡œ ê¸°ë°˜ ë””ë°”ì´ìŠ¤ ID í•¸ë“¤ëŸ¬ (Fully Kiosk í˜¸í™˜) -->
    <script src="device-id-handler.js"></script>
  </head>
  <body>
    <!-- í”„ë¦¬ë¡œë”© ìŠ¤í¬ë¦° -->
    <div id="preloadingScreen" class="preloading-overlay">
      <div class="preloading-container">
        <div class="preloading-logo">DUNLOPILLO</div>
        
        <div class="preloading-progress">
          <div id="preloadingFill" class="preloading-fill"></div>
        </div>
        
        <div id="preloadingText" class="preloading-text">ì´ë¯¸ì§€ í”„ë¦¬ë¡œë”© ì‹œì‘...</div>
        <div id="preloadingDetails" class="preloading-details">
          ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”
        </div>
        
        <div class="preloading-stats">
          <div class="stat-item">
            <div id="statLoaded" class="stat-number">0</div>
            <div class="stat-label">ë¡œë“œ ì™„ë£Œ</div>
          </div>
          <div class="stat-item">
            <div id="statTotal" class="stat-number">0</div>
            <div class="stat-label">ì „ì²´ ì´ë¯¸ì§€</div>
          </div>
          <div class="stat-item">
            <div id="statProgress" class="stat-number">0%</div>
            <div class="stat-label">ì§„í–‰ë¥ </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ë””ë²„ê·¸ ì •ë³´ í‘œì‹œ (ì„ì‹œ) - screen-container ë°–ì—ì„œ í•­ìƒ í‘œì‹œ -->
    <!-- 
    <div id="debugInfo" style="position: fixed; top: 20px; left: 20px; background: rgba(255,0,0,0.9); color: white; padding: 8px; border-radius: 5px; font-size: 12px; z-index: 99999; font-family: monospace; font-weight: bold;">
      í¬ê¸°: <span id="screenSize">í™•ì¸ì¤‘...</span>
    </div>
    -->
    
    <!-- ê¸€ë¡œë²Œ êµ¬ì¡°: ì „ì²´ ë°”íƒ•(ì°í•œ íšŒìƒ‰) + í™”ë©´(1280x800 ì˜…ì€ íšŒìƒ‰) -->
    <div class="screen-container" id="app">
      <!-- ì—¬ê¸°ì— ê° í˜ì´ì§€ ì»¨í…ì¸ ê°€ ë Œë”ë§ë©ë‹ˆë‹¤ -->
    </div>
    
    <!-- JavaScript íŒŒì¼ë“¤ - ìˆœì„œ ì¤‘ìš”! -->
    <script src="survey-data-manager.js"></script>
    <script src="survey-data.js"></script>
    <script src="screens.js"></script>
    
    <!-- ê°„ë‹¨í•œ ì´ë¯¸ì§€ í”„ë¦¬ë¡œë” -->
    <script>
      // í”„ë¦¬ë¡œë”© ìƒíƒœ ê´€ë¦¬
      let preloadStartTime = Date.now();
      let mainAppStarted = false;

      // ë¡œë”© ìŠ¤í¬ë¦° ì—…ë°ì´íŠ¸
      function updatePreloadingScreen(loaded, total, currentImage, progress) {
        const preloadingFill = document.getElementById('preloadingFill');
        const preloadingText = document.getElementById('preloadingText');
        const preloadingDetails = document.getElementById('preloadingDetails');
        const statLoaded = document.getElementById('statLoaded');
        const statTotal = document.getElementById('statTotal');
        const statProgress = document.getElementById('statProgress');

        if (preloadingFill) preloadingFill.style.width = `${progress}%`;
        if (preloadingText) preloadingText.textContent = `ì´ë¯¸ì§€ ë¡œë”© ì¤‘... ${progress}%`;
        if (preloadingDetails) {
          const elapsed = Math.round((Date.now() - preloadStartTime) / 1000);
          preloadingDetails.textContent = `${loaded}/${total} ì™„ë£Œ (${elapsed}ì´ˆ ê²½ê³¼)`;
        }
        if (statLoaded) statLoaded.textContent = loaded;
        if (statTotal) statTotal.textContent = total;
        if (statProgress) statProgress.textContent = `${progress}%`;
      }

      // í”„ë¦¬ë¡œë”© ì™„ë£Œ ì²˜ë¦¬
      function onPreloadingComplete(loaded, failed) {
        const totalTime = Math.round((Date.now() - preloadStartTime) / 1000);
        console.log(`ğŸ‰ í”„ë¦¬ë¡œë”© ì™„ë£Œ: ì„±ê³µ ${loaded}ê°œ, ì‹¤íŒ¨ ${failed}ê°œ, ${totalTime}ì´ˆ ì†Œìš”`);
        
        setTimeout(() => {
          // ë¡œë”© ìŠ¤í¬ë¦° í˜ì´ë“œì•„ì›ƒ
          const preloadingScreen = document.getElementById('preloadingScreen');
          if (preloadingScreen) {
            preloadingScreen.classList.add('fade-out');
            
            // í˜ì´ë“œì•„ì›ƒ ì™„ë£Œ í›„ ë©”ì¸ ì•± ì‹œì‘
            setTimeout(() => {
              preloadingScreen.style.display = 'none';
              startMainApp();
            }, 500);
          } else {
            startMainApp();
          }
        }, 1000); // 1ì´ˆ ë” í‘œì‹œ
      }

      // ë©”ì¸ ì•± ì‹œì‘
      function startMainApp() {
        if (mainAppStarted) return;
        mainAppStarted = true;
        
        console.log('ğŸš€ ë©”ì¸ ì•± ì‹œì‘!');
        
        // ê¸°ì¡´ ì•± ì´ˆê¸°í™” - MotionBedApp ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
        if (typeof MotionBedApp !== 'undefined') {
          MotionBedApp.getInstance();
        } else {
          console.warn('âš ï¸ MotionBedAppì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
        }
      }

      // ğŸš€ ê°•í™”ëœ ì´ë¯¸ì§€ í”„ë¦¬ë¡œë” (ë©”ëª¨ë¦¬ ìºì‹œ + ì°¸ì¡° ìœ ì§€)
      let imageCache = new Map(); // ì´ë¯¸ì§€ ê°ì²´ ìºì‹œ
      
      async function startSimpleImagePreloading() {
        console.log('ğŸš€ ê°•í™”ëœ ì´ë¯¸ì§€ í”„ë¦¬ë¡œë”© ì‹œì‘!');
        preloadStartTime = Date.now();
        
        if (!window.IMG) {
          console.error('âŒ IMG ê°ì²´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
          setTimeout(() => onPreloadingComplete(0, 0), 1000);
          return;
        }

        const images = Object.entries(window.IMG).map(([key, url]) => ({ key, url }));
        console.log(`ğŸ“Š ì´ ${images.length}ê°œ ì´ë¯¸ì§€ ë°œê²¬`);
        
        let loadedCount = 0;
        let failedCount = 0;
        
        // í”„ë¡œê·¸ë ˆìŠ¤ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateProgress() {
          const total = images.length;
          const completed = loadedCount + failedCount;
          const progress = total > 0 ? Math.round((completed / total) * 100) : 0;
          
          updatePreloadingScreen(loadedCount, total, 'ì§„í–‰ ì¤‘...', progress);
        }
        
        // ê°•í™”ëœ ë‹¨ì¼ ì´ë¯¸ì§€ ë¡œë“œ í•¨ìˆ˜ (ë©”ëª¨ë¦¬ ìºì‹œ + ë””ì½”ë”©)
        function loadSingleImage(imageInfo) {
          return new Promise((resolve, reject) => {
            const { key, url } = imageInfo;
            const img = new Image();
            
            const startTime = Date.now();
            
            // ğŸ”¥ ì¤‘ìš”: ì´ë¯¸ì§€ ë””ì½”ë”© ìµœì í™”
            img.decoding = 'async'; // ë¹„ë™ê¸° ë””ì½”ë”©ìœ¼ë¡œ ì„±ëŠ¥ í–¥ìƒ
            img.loading = 'eager';  // ì¦‰ì‹œ ë¡œë”©
            
            const timeout = setTimeout(() => {
              failedCount++;
              console.warn(`â° ${key} íƒ€ì„ì•„ì›ƒ (30ì´ˆ)`);
              updateProgress();
              reject(new Error(`Timeout: ${key}`));
            }, 30000);
            
            img.onload = () => {
              clearTimeout(timeout);
              const loadTime = Date.now() - startTime;
              
              // ğŸš€ ë©”ëª¨ë¦¬ ìºì‹œì— ì €ì¥ (DOM ì°¸ì¡° ìœ ì§€)
              imageCache.set(key, img);
              imageCache.set(url, img); // URLë¡œë„ ì ‘ê·¼ ê°€ëŠ¥
              
              loadedCount++;
              console.log(`âœ… ${key} ë¡œë“œ ì™„ë£Œ (${loadTime}ms) - ìºì‹œ ì €ì¥ë¨`);
              updateProgress();
              
              // ğŸ”¥ ì¶”ê°€ ìµœì í™”: ì´ë¯¸ì§€ ë””ì½”ë”© ì™„ë£Œ í™•ì¸
              if (img.decode) {
                img.decode().then(() => {
                  console.log(`ğŸ¯ ${key} ë””ì½”ë”© ì™„ë£Œ - ì¦‰ì‹œ í‘œì‹œ ê°€ëŠ¥`);
                  resolve();
                }).catch(() => {
                  console.log(`âš ï¸ ${key} ë””ì½”ë”© ì‹¤íŒ¨í•˜ì§€ë§Œ ë¡œë“œëŠ” ì„±ê³µ`);
                  resolve();
                });
              } else {
                resolve();
              }
            };
            
            img.onerror = () => {
              clearTimeout(timeout);
              const loadTime = Date.now() - startTime;
              failedCount++;
              console.warn(`âŒ ${key} ë¡œë“œ ì‹¤íŒ¨ (${loadTime}ms)`);
              updateProgress();
              reject(new Error(`Failed: ${key}`));
            };
            
            // ì‹¤ì œ ê²½ë¡œ ì²˜ë¦¬
            let actualUrl = url;
            if (url.startsWith('assets/')) {
              actualUrl = url; // ë©”ì¸ í˜ì´ì§€ì—ì„œëŠ” ê·¸ëŒ€ë¡œ ì‚¬ìš©
            }
            
            img.src = actualUrl;
          });
        }
        
        // ë°°ì¹˜ ë¡œë”© (5ê°œì”©)
        const batchSize = 5;
        const batches = [];
        
        for (let i = 0; i < images.length; i += batchSize) {
          batches.push(images.slice(i, i + batchSize));
        }
        
        console.log(`ğŸ“¦ ${batches.length}ê°œ ë°°ì¹˜ë¡œ ë¡œë”© ì‹œì‘`);
        
        for (let i = 0; i < batches.length; i++) {
          const batch = batches[i];
          console.log(`ğŸ”„ ë°°ì¹˜ ${i + 1}/${batches.length} ì‹œì‘ (${batch.length}ê°œ ì´ë¯¸ì§€)`);
          
          const promises = batch.map(imageInfo => 
            loadSingleImage(imageInfo).catch(() => {
              // ì‹¤íŒ¨í•´ë„ ê³„ì† ì§„í–‰
            })
          );
          
          await Promise.allSettled(promises);
          
          // ë°°ì¹˜ ê°„ 100ms ì§€ì—°
          if (i < batches.length - 1) {
            await new Promise(resolve => setTimeout(resolve, 100));
          }
        }
        
        const totalTime = Math.round((Date.now() - preloadStartTime) / 1000);
        console.log(`ğŸ‰ í”„ë¦¬ë¡œë”© ì™„ë£Œ! ì´ ${totalTime}ì´ˆ ì†Œìš”`);
        console.log(`ğŸ“Š ì„±ê³µ: ${loadedCount}ê°œ, ì‹¤íŒ¨: ${failedCount}ê°œ`);
        console.log(`ğŸ—„ï¸ ë©”ëª¨ë¦¬ ìºì‹œì— ${imageCache.size}ê°œ ì´ë¯¸ì§€ ì €ì¥ë¨`);
        
        // ğŸš€ ì „ì—­ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ìºì‹œ ë…¸ì¶œ
        window.preloadedImageCache = imageCache;
        window.getPreloadedImage = function(keyOrUrl) {
          const cached = imageCache.get(keyOrUrl);
          if (cached) {
            console.log(`ğŸ¯ ìºì‹œì—ì„œ ì´ë¯¸ì§€ ë°˜í™˜: ${keyOrUrl}`);
            return cached.cloneNode(); // ë³µì‚¬ë³¸ ë°˜í™˜ìœ¼ë¡œ ì•ˆì „ì„± í™•ë³´
          }
          console.warn(`âš ï¸ ìºì‹œì—ì„œ ì´ë¯¸ì§€ë¥¼ ì°¾ì§€ ëª»í•¨: ${keyOrUrl}`);
          return null;
        };
        
        // ì™„ë£Œ ì²˜ë¦¬
        onPreloadingComplete(loadedCount, failedCount);
      }

      // DOM ë¡œë“œ ì™„ë£Œ ì‹œ í”„ë¦¬ë¡œë”© ì‹œì‘ (ê¸°ì¡´ DOMContentLoaded ì°¨ë‹¨)
      document.addEventListener('DOMContentLoaded', (e) => {
        console.log('ğŸ¯ DOM ë¡œë“œ ì™„ë£Œ - í”„ë¦¬ë¡œë”© ìš°ì„  ì‹¤í–‰');
        
        // ê¸°ì¡´ DOMContentLoaded ì´ë²¤íŠ¸ ì „íŒŒ ì°¨ë‹¨
        e.stopImmediatePropagation();
        
        // í”„ë¦¬ë¡œë”© ì‹œì‘ (ì•½ê°„ì˜ ì§€ì—° í›„)
        setTimeout(() => {
          startSimpleImagePreloading();
        }, 100);
      });

      console.log('ğŸš€ ê°„ë‹¨í•œ í”„ë¦¬ë¡œë” ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì™„ë£Œ');
    </script>
    
    <script src="script.js"></script>
    
    <!-- ë””ë²„ê¹…ìš© ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ -->
    <script>
      console.log('ğŸ“ HTML ë¡œë”© ì™„ë£Œ');
      console.log('ğŸ” screens ê°ì²´ í™•ì¸:', typeof window.screens);
      console.log('ğŸ” surveyData ê°ì²´ í™•ì¸:', typeof window.surveyData);
      
      // ë™ì˜ìƒ ë””ë²„ê¹…
      console.log('ğŸ¬ VIDEO_SOURCES í™•ì¸:', window.VIDEO_SOURCES);
      console.log('ğŸ¬ USE_VIDEO_BACKGROUND í™•ì¸:', window.USE_VIDEO_BACKGROUND);
      
      // ğŸ–¥ï¸ ì „ì²´í™”ë©´ í•¨ìˆ˜ë“¤ì„ ê°€ì¥ ë¨¼ì € ì •ì˜ (ì „ì—­ ì ‘ê·¼ ê°€ëŠ¥)
      // ì „ì²´í™”ë©´ í† ê¸€ í•¨ìˆ˜ (íƒœë¸”ë¦¿ ìµœì í™” ê°œì„ )
      function toggleFullscreen() {
        console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ í† ê¸€ í•¨ìˆ˜ í˜¸ì¶œë¨!');
        
        const elem = document.documentElement;
        
        // í˜„ì¬ ì „ì²´í™”ë©´ ìƒíƒœ í™•ì¸
        const isFullscreen = !!(document.fullscreenElement || document.webkitFullscreenElement);
        console.log('ğŸ–¥ï¸ í˜„ì¬ ì „ì²´í™”ë©´ ìƒíƒœ:', isFullscreen);
        console.log('ğŸ–¥ï¸ í˜„ì¬ í™”ë©´ í¬ê¸°:', `${window.screen.width}x${window.screen.height}`);
        console.log('ğŸ–¥ï¸ ë·°í¬íŠ¸ í¬ê¸°:', `${window.innerWidth}x${window.innerHeight}`);
        
        if (isFullscreen) {
          // ì „ì²´í™”ë©´ í•´ì œ (ì•ˆì „í•˜ê²Œ)
          console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ í•´ì œ ì‹œë„');
          if (document.exitFullscreen) {
            document.exitFullscreen().catch(err => {
              console.warn('ğŸ–¥ï¸ ì „ì²´í™”ë©´ í•´ì œ ì‹¤íŒ¨:', err);
            });
          } else if (document.webkitExitFullscreen) {
            document.webkitExitFullscreen();
          }
        } else {
          // ì „ì²´í™”ë©´ ì§„ì… (ì•ˆì „í•˜ê²Œ)
          console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ì§„ì… ì‹œë„');
          
          // ë§¥ë¶ í¬ë¡¬ í˜¸í™˜ì„ ìœ„í•œ ì•ˆì „í•œ ìš”ì²­
          if (elem.requestFullscreen) {
            elem.requestFullscreen().then(() => {
              console.log('ğŸ–¥ï¸ âœ… ì „ì²´í™”ë©´ ì§„ì… ì„±ê³µ');
            }).catch(err => {
              console.warn('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ì§„ì… ì‹¤íŒ¨:', err);
              // navigationUI ì˜µì…˜ ì—†ì´ ì¬ì‹œë„
              elem.requestFullscreen().catch(err2 => {
                console.error('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ì§„ì… ì™„ì „ ì‹¤íŒ¨:', err2);
              });
            });
          } else if (elem.webkitRequestFullscreen) {
            // Safari/Chrome êµ¬í˜• ë²„ì „ ì§€ì›
            elem.webkitRequestFullscreen();
          }
        }
      }
      
      // ì „ì—­ìœ¼ë¡œ ë“±ë¡
      window.toggleFullscreen = toggleFullscreen;
      
      window.updateFullscreenButton = function(isFullscreen) {
        console.log('ğŸ–¥ï¸ ë²„íŠ¼ ì—…ë°ì´íŠ¸:', isFullscreen ? 'ì „ì²´í™”ë©´ ëª¨ë“œ' : 'ì¼ë°˜ ëª¨ë“œ');
        
        const fullscreenBtn = document.getElementById('fullscreenToggle');
        if (!fullscreenBtn) {
          console.warn('ğŸ–¥ï¸ âš ï¸ ì „ì²´í™”ë©´ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
          return;
        }
        
        try {
          if (isFullscreen) {
            fullscreenBtn.innerHTML = `
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M5 16H8V14H5V16ZM8 8H5V10H8V8ZM14 19H16V16H14V19ZM16 8V5H14V8H16ZM14 14H16V16H14V14ZM8 10H10V8H8V10ZM10 14V16H8V14H10ZM16 10H14V8H16V10Z" fill="currentColor"/>
              </svg>
            `;
            fullscreenBtn.title = 'ì „ì²´í™”ë©´ í•´ì œ';
          } else {
            fullscreenBtn.innerHTML = `
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M7 14H5V19H10V17H7V14Z" fill="currentColor"/>
                <path d="M5 10H7V7H10V5H5V10Z" fill="currentColor"/>
                <path d="M17 14H19V19H14V17H17V14Z" fill="currentColor"/>
                <path d="M14 5V7H17V10H19V5H14Z" fill="currentColor"/>
              </svg>
            `;
            fullscreenBtn.title = 'ì „ì²´í™”ë©´ ëª¨ë“œ';
          }
          console.log('ğŸ–¥ï¸ âœ… ë²„íŠ¼ ì•„ì´ì½˜ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
        } catch (error) {
          console.error('ğŸ–¥ï¸ âŒ ë²„íŠ¼ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
        }
      };
      
      // ì „ì²´í™”ë©´ ìƒíƒœ ë³€ê²½ ê°ì§€
      window.handleFullscreenChange = function() {
        const isFullscreen = !!(document.fullscreenElement || 
                               document.webkitFullscreenElement || 
                               document.mozFullScreenElement || 
                               document.msFullscreenElement);
        
        console.log(`ğŸ–¥ï¸ ì „ì²´í™”ë©´ ìƒíƒœ ë³€ê²½ ì´ë²¤íŠ¸: ${isFullscreen ? 'í™œì„±í™”' : 'í•´ì œ'}`);
        window.updateFullscreenButton(isFullscreen);
        
        if (isFullscreen) {
          document.body.classList.add('fullscreen-mode');
        } else {
          document.body.classList.remove('fullscreen-mode');
        }
      };
      
      // ì „ì²´í™”ë©´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
      document.addEventListener('fullscreenchange', window.handleFullscreenChange);
      document.addEventListener('webkitfullscreenchange', window.handleFullscreenChange);
      document.addEventListener('mozfullscreenchange', window.handleFullscreenChange);
      document.addEventListener('MSFullscreenChange', window.handleFullscreenChange);
      
      console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ í•¨ìˆ˜ë“¤ì´ ì „ì—­ìœ¼ë¡œ ì •ì˜ë˜ì—ˆìŠµë‹ˆë‹¤');
      
      // ğŸ”Š í™ˆ í™”ë©´ ì‚¬ìš´ë“œ í† ê¸€ í•¨ìˆ˜ (ë¨¼ì € ì •ì˜)
      function toggleVideoSound(event) {
        event.stopPropagation(); // â— ë¶€ëª¨ë¡œ ì´ë²¤íŠ¸ ì „íŒŒ ë°©ì§€

        const video = document.getElementById("homeBackgroundVideo");
        const icon = document.getElementById("soundToggle");

        if (!video) {
          console.warn('ğŸ”Š í™ˆ ë™ì˜ìƒ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
          return;
        }

        if (!icon) {
          console.warn('ğŸ”Š ì‚¬ìš´ë“œ í† ê¸€ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
          return;
        }

        // í™ˆ ë™ì˜ìƒì€ í•­ìƒ ìŒì†Œê±° ìƒíƒœ ìœ ì§€ (ì˜ìƒë§Œ, ì†Œë¦¬ ì—†ìŒ)
        video.muted = true;
        video.volume = 0;
        console.log('ğŸ¬ í™ˆ ë™ì˜ìƒì€ í•­ìƒ ìŒì†Œê±° ìœ ì§€ (ì˜ìƒë§Œ)');

        // ë°°ê²½ìŒì•…ë§Œ í† ê¸€
        if (typeof toggleBackgroundMusic === 'function') {
          const isMusicEnabled = toggleBackgroundMusic();
          icon.textContent = isMusicEnabled ? "ğŸ”Š" : "ğŸ”‡";
          console.log(`ğŸµ ë°°ê²½ìŒì•…ë§Œ ${isMusicEnabled ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}`);
        } else {
          console.warn('ğŸµ ë°°ê²½ìŒì•… í† ê¸€ í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
        }
      }

      // ì „ì—­ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
      window.toggleVideoSound = toggleVideoSound;
      
      // ğŸµ ë°°ê²½ ìŒì•… ìë™ ì¬ìƒ ì‹œìŠ¤í…œ
      let backgroundAudio = null;
      let currentAudioIndex = 0;
      let isMusicEnabled = true; // ìŒì•… í™œì„±í™” ìƒíƒœ (ì „ì—­ ìœ ì§€)
      let musicInteractionListenerAdded = false; // ì¤‘ë³µ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë°©ì§€
      
      // ğŸ™ï¸ AI ìŒì„± ê°€ì´ë“œ ì‹œìŠ¤í…œ (í•œ ë²ˆë§Œ ì„ ì–¸)
      let voiceAudio = null;
      let isVoiceEnabled = true;
      let isVoicePlaying = false;
      let userHasInteracted = false; // ì‚¬ìš©ì ìƒí˜¸ì‘ìš© í™•ì¸
      
      // â° ìë™ ì§„í–‰ ì‹œìŠ¤í…œ
      let autoProgressTimer = null;
      let countdownTimer = null;
      let currentCountdown = 0;
      let isAutoProgressActive = false;
      
      // ë°°ê²½ ìŒì•… ì†ŒìŠ¤ë“¤ (ë™ì˜ìƒì—ì„œ ì˜¤ë””ì˜¤ë§Œ ì¶”ì¶œ)
      const BACKGROUND_AUDIO_SOURCES = [
        'https://res.cloudinary.com/di2pd92t1/video/upload/v1748237173/Dunlopillo-Crash-Test-Flexibilitet-web_n045ph.mp4',
        'https://res.cloudinary.com/di2pd92t1/video/upload/v1748237657/Dunlopillo-Crash-Test-Stabilitet-web_mvxr27.mp4',
        'https://res.cloudinary.com/di2pd92t1/video/upload/v1748241410/Dunlopillo-Crash-Test-Allergivenlig-A%CC%8Andba%CC%8Ar-web_wxolsb.mp4'
      ];

      // í˜ì´ì§€ë³„ ìŒì„± íŒŒì¼ ë§¤í•‘ (ì‹¤ì œ ë¡œì»¬ íŒŒì¼ ê¸°ì¤€)
      const VOICE_SCRIPTS = {
        'page3': 'assets/voices/voice_page3.mp3',
        'page4': 'assets/voices/voice_page4.mp3', 
        'page5': 'assets/voices/voice_page5.mp3',
        'page6': 'assets/voices/voice_tip1.mp3',
        'page7': 'assets/voices/voice_page7.mp3',
        'page8': 'assets/voices/voice_page8.mp3',
        'page9': 'assets/voices/voice_tip2.mp3',
        'page10': 'assets/voices/voice_page10.mp3',
        'page11': 'assets/voices/voice_page11.mp3',
        'page12': 'assets/voices/voice_page12.mp3',
        'page13': 'assets/voices/voice_page13.mp3',
        'page14': 'assets/voices/voice_tip3.mp3',
        'page15': 'assets/voices/voice_page15.mp3',
        'page16-1': 'assets/voices/voice_tip4.mp3',
        'page16-2': 'assets/voices/voice_tip5.mp3', // voice_tip5ë¡œ ë³€ê²½
        'page17': 'assets/voices/voice_page17.mp3'
      };

      // ì „ì—­ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
      window.VOICE_SCRIPTS = VOICE_SCRIPTS;

      // â° ìë™ ì§„í–‰ ì„¤ì • (í˜ì´ì§€ë³„)
      const AUTO_PROGRESS_CONFIG = {
        // í™ˆ í™”ë©´: ìë™ ì§„í–‰ ë¹„í™œì„±í™” (ìˆ˜ë™ í„°ì¹˜ë§Œ ê°€ëŠ¥)
        'home': { hasVoice: false, delay: 0 },
        
        // ìŒì„± ì•ˆë‚´ ìˆëŠ” í˜ì´ì§€ë“¤ (ìŒì„± ì¢…ë£Œ í›„ 5ì´ˆ)
        'page3': { hasVoice: true, delay: 9 },
        'page4': { hasVoice: true, delay: 30 },
        'page5': { hasVoice: true, delay: 5 },  // ë³„ì 1
        'page6': { hasVoice: true, delay: 9 },  // TIP1 - voice_tip1
        'page7': { hasVoice: true, delay: 30 },
        'page8': { hasVoice: true, delay: 5 }, // ë³„ì 2
        'page9': { hasVoice: true, delay: 9 },  // TIP2 - voice_tip2
        'page10': { hasVoice: true, delay: 5 },
        'page11': { hasVoice: true, delay: 30 }, // 1ë¶„ ëŒ€ê¸°
        'page12': { hasVoice: true, delay: 5 }, // ë³„ì 3
        'page13': { hasVoice: true, delay: 30 }, // ì œë¡œì§€
        'page14': { hasVoice: true, delay: 5 },  // TIP3 - voice_tip3
        'page15': { hasVoice: true, delay: 30 }, // ë‹¤ì‹œ ì›ë˜ëŒ€ë¡œ ~ í”Œë« ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”~
        'page16-1': { hasVoice: true, delay: 5 },  // TIP4 - voice_tip4
        'page16-2': { hasVoice: true, delay: 5 },  // TIP5 - voice_tip5
        'page17': { hasVoice: true, delay: 30 }, // ì´ì œ ë¦¬ëª¨ì»¨ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ì…˜ë² ë“œë¥¼ ì²´í—˜í•´ë³´ì„¸ìš”.
        
        // ìŒì„± ì•ˆë‚´ ì—†ëŠ” í˜ì´ì§€ë“¤ (ìë™ ì§„í–‰)
        'page18': { hasVoice: false, delay: 5 },
        'page19': { hasVoice: false, delay: 30 } // í™ˆ ë²„íŠ¼ì—ë„ 30ì´ˆ ìë™ ì§„í–‰ íš¨ê³¼
        // page1, page2ëŠ” ìë™ ì§„í–‰ ì—†ìŒ
      };

      function initBackgroundMusic() {
        // ë°°ê²½ ìŒì•… ìš”ì†Œ ìƒì„±
        backgroundAudio = document.createElement('audio');
        backgroundAudio.loop = false; // ê°œë³„ íŠ¸ë™ì´ ëë‚˜ë©´ ë‹¤ìŒìœ¼ë¡œ
        backgroundAudio.volume = 1.0; // ìµœëŒ€ ë³¼ë¥¨ (100%)
        backgroundAudio.preload = 'auto';
        
        // ì²« ë²ˆì§¸ ì†ŒìŠ¤ ì„¤ì •
        backgroundAudio.src = BACKGROUND_AUDIO_SOURCES[currentAudioIndex];
        
        // ì¬ìƒ ì‹œì‘ ë¡œê·¸ ì¶”ê°€
        backgroundAudio.addEventListener('play', () => {
          console.log('ğŸµ [PLAY] ë°°ê²½ìŒì•… ì¬ìƒ ì‹œì‘:', backgroundAudio.src);
          console.trace('ğŸµ [TRACE] ì¬ìƒ í˜¸ì¶œ ìŠ¤íƒ:');
        });
        
        // íŠ¸ë™ ì¢…ë£Œ ì‹œ ë‹¤ìŒ íŠ¸ë™ìœ¼ë¡œ ìë™ ì „í™˜
        backgroundAudio.addEventListener('ended', () => {
          currentAudioIndex = (currentAudioIndex + 1) % BACKGROUND_AUDIO_SOURCES.length;
          backgroundAudio.src = BACKGROUND_AUDIO_SOURCES[currentAudioIndex];
          if (isMusicEnabled) {
            console.log('ğŸµ [AUTO] ë‹¤ìŒ íŠ¸ë™ ìë™ ì¬ìƒ:', backgroundAudio.src);
            backgroundAudio.play().catch(error => {
              console.warn('ë‹¤ìŒ íŠ¸ë™ ì¬ìƒ ì‹¤íŒ¨:', error);
            });
          }
        });
        
        // ì „ì—­ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
        window.backgroundAudio = backgroundAudio;
        window.isMusicEnabled = isMusicEnabled;
        window.backgroundMusicSystem = {
          audio: backgroundAudio,
          toggle: toggleBackgroundMusic,
          isEnabled: () => isMusicEnabled,
          syncWithHomeVideo: syncMusicWithHomeVideo
        };
        
        console.log('ğŸµ ë°°ê²½ ìŒì•… ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ');
      }

      // ğŸ™ï¸ AI ìŒì„± ê°€ì´ë“œ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
      function initVoiceGuide() {
        // ì´ë¯¸ ì´ˆê¸°í™”ëœ ê²½ìš° ì¤‘ë³µ ë°©ì§€
        if (voiceAudio) {
          console.warn('ğŸ™ï¸ âš ï¸ voiceAudioê°€ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤ - ì¤‘ë³µ ì´ˆê¸°í™” ë°©ì§€');
          return;
        }
        
        voiceAudio = document.createElement('audio');
        voiceAudio.volume = 0.8; // ìŒì„±ì€ ë°°ê²½ìŒì•…ë³´ë‹¤ í¬ê²Œ
        voiceAudio.preload = 'auto';
        
        // ìŒì„± ì¬ìƒ ì‹œì‘ ë¡œê·¸ ì¶”ê°€
        voiceAudio.addEventListener('play', () => {
          console.log('ğŸ™ï¸ [PLAY] ìŒì„± ê°€ì´ë“œ ì¬ìƒ ì‹œì‘:', voiceAudio.src);
          console.trace('ğŸ™ï¸ [TRACE] ìŒì„± ì¬ìƒ í˜¸ì¶œ ìŠ¤íƒ:');
        });
        
        // ìŒì„± ë¡œë”© ì™„ë£Œ
        voiceAudio.addEventListener('loadeddata', () => {
          console.log('ğŸ™ï¸ [DEBUG] ìŒì„± íŒŒì¼ ë¡œë“œ ì™„ë£Œ:', voiceAudio.src);
        });

        // ìŒì„± ë¡œë”© ì‹œì‘
        voiceAudio.addEventListener('loadstart', () => {
          console.log('ğŸ™ï¸ [DEBUG] ìŒì„± íŒŒì¼ ë¡œë”© ì‹œì‘:', voiceAudio.src);
        });
        
        // ìŒì„± ì¬ìƒ ì™„ë£Œ ì‹œ ë°°ê²½ìŒì•… ë³µêµ¬ + ìë™ ì§„í–‰ ì‹œì‘
        voiceAudio.addEventListener('ended', () => {
          isVoicePlaying = false;
          restoreBackgroundMusicVolume();
          console.log('ğŸ™ï¸ ìŒì„± ê°€ì´ë“œ ì¬ìƒ ì™„ë£Œ');
          
          // ìŒì„± ì¢…ë£Œ í›„ ìë™ ì§„í–‰ ì‹œì‘
          const currentPage = getCurrentPageName();
          const config = AUTO_PROGRESS_CONFIG[currentPage];
          if (config && config.hasVoice) {
            console.log(`â° [AUTO] ìŒì„± ì¢…ë£Œ â†’ ìë™ ì§„í–‰ ì‹œì‘ (${config.delay}ì´ˆ)`);
            startCountdown(config.delay);
          }
        });

        // ìŒì„± ì¬ìƒ ì˜¤ë¥˜ ì²˜ë¦¬
        voiceAudio.addEventListener('error', (e) => {
          console.error('ğŸ™ï¸ âŒ ìŒì„± ê°€ì´ë“œ ì¬ìƒ ì‹¤íŒ¨:', e);
          console.error('ğŸ™ï¸ [ERROR] ì˜¤ë¥˜ ì½”ë“œ:', voiceAudio.error?.code);
          console.error('ğŸ™ï¸ [ERROR] ì˜¤ë¥˜ ë©”ì‹œì§€:', voiceAudio.error?.message);
          console.error('ğŸ™ï¸ [ERROR] íŒŒì¼ ê²½ë¡œ:', voiceAudio.src);
          isVoicePlaying = false;
          restoreBackgroundMusicVolume();
        });

        // ì „ì—­ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
        window.voiceGuideSystem = {
          audio: voiceAudio,
          playVoiceForPage: playVoiceForPage,
          stopVoice: stopVoice,
          isEnabled: () => isVoiceEnabled,
          toggle: toggleVoiceGuide
        };

        // â° ìë™ ì§„í–‰ ì‹œìŠ¤í…œë„ ì „ì—­ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
        window.startAutoProgress = startAutoProgress;
        window.clearAutoProgress = clearAutoProgress;
        window.AUTO_PROGRESS_CONFIG = AUTO_PROGRESS_CONFIG;

        console.log('ğŸ™ï¸ AI ìŒì„± ê°€ì´ë“œ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ');
      }

      // â° ìë™ ì§„í–‰ ì‹œìŠ¤í…œ
      function startAutoProgress(pageName) {
        console.log(`â° [AUTO] ìë™ ì§„í–‰ ì‹œì‘: ${pageName}`);
        
        // ê¸°ì¡´ íƒ€ì´ë¨¸ë“¤ ì •ë¦¬
        clearAutoProgress();
        
        const config = AUTO_PROGRESS_CONFIG[pageName];
        if (!config || config.delay <= 0) {
          console.log(`â° [AUTO] ìë™ ì§„í–‰ ì„¤ì • ì—†ìŒ ë˜ëŠ” delayê°€ 0: ${pageName}`);
          return;
        }

        isAutoProgressActive = true;
        
        if (config.hasVoice && VOICE_SCRIPTS[pageName]) {
          // ìŒì„± ì•ˆë‚´ í˜ì´ì§€: ìŒì„± ì¢…ë£Œ í›„ ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘
          console.log(`â° [AUTO] ìŒì„± ì¢…ë£Œ ëŒ€ê¸° ì¤‘...`);
          // ìŒì„± ì¢…ë£ŒëŠ” voiceAudioì˜ 'ended' ì´ë²¤íŠ¸ì—ì„œ ì²˜ë¦¬
        } else {
          // ì¼ë°˜ í˜ì´ì§€: ì¦‰ì‹œ ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘
          startCountdown(config.delay);
        }
      }

      function startCountdown(seconds) {
        if (!isAutoProgressActive) return;
        
        console.log(`â° [AUTO] ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘: ${seconds}ì´ˆ`);
        currentCountdown = seconds;
        updateNextButtonText();
        
        countdownTimer = setInterval(() => {
          currentCountdown--;
          updateNextButtonText();
          
          if (currentCountdown <= 0) {
            clearAutoProgress();
            autoGoToNextPage();
          }
        }, 1000);
      }

      function updateNextButtonText() {
        // ë‹¤ì–‘í•œ ë²„íŠ¼ í´ë˜ìŠ¤ ì‹œë„ (í™ˆ ë²„íŠ¼ í¬í•¨)
        const nextButton = document.querySelector('.nav-btn.next-btn') || 
                          document.querySelector('.navigation-button.next') ||
                          document.querySelector('button[onclick*="next()"]') ||
                          document.querySelector('.page19-home-btn') || // page19 í™ˆ ë²„íŠ¼
                          document.querySelector('button[onclick*="goHome()"]') || // goHome ë²„íŠ¼
                          document.querySelector('button'); // ì¼ë°˜ ë²„íŠ¼
                          
        console.log(`â° [DEBUG] ë‹¤ìŒ/í™ˆ ë²„íŠ¼ ì°¾ê¸°:`, nextButton);
        
        if (nextButton && isAutoProgressActive) {
          // ì›ë˜ í…ìŠ¤íŠ¸ í™•ì¸
          let originalText = 'ë‹¤ìŒ>';
          if (nextButton.textContent.includes('í™ˆìœ¼ë¡œ')) {
            originalText = 'í™ˆìœ¼ë¡œ';
          } else if (nextButton.textContent.includes('ë‹¤ìŒ')) {
            originalText = nextButton.textContent.includes('>') ? 'ë‹¤ìŒ>' : 'ë‹¤ìŒ';
          }
          
          // íƒ€ì´ë¨¸ í…ìŠ¤íŠ¸ ì œê±° - ì›ë˜ í…ìŠ¤íŠ¸ë§Œ ìœ ì§€
          nextButton.textContent = originalText;
          
          // ë¶€ë“œëŸ¬ìš´ ì„ í˜• í”„ë¡œê·¸ë ˆìŠ¤ íš¨ê³¼ (íšŒìƒ‰ â†’ íŒŒë€ìƒ‰)
          const totalSeconds = AUTO_PROGRESS_CONFIG[getCurrentPageName()]?.delay || 7;
          const progress = ((totalSeconds - currentCountdown) / totalSeconds) * 100;
          
          // ê¸°ì¡´ ë°°ê²½ìƒ‰ì„ í•œ ë²ˆë§Œ ì €ì¥
          if (!nextButton.dataset.originalBackground) {
            const computedStyle = window.getComputedStyle(nextButton);
            
            // í™ˆ ë²„íŠ¼ì˜ ê²½ìš° íšŒìƒ‰ ë°°ê²½ìœ¼ë¡œ ê°•ì œ ì„¤ì •
            if (nextButton.textContent.includes('í™ˆìœ¼ë¡œ')) {
              nextButton.dataset.originalBackground = '#efefef';
              nextButton.dataset.originalBorder = computedStyle.border || '';
              nextButton.dataset.originalColor = '#000000';
            } else {
              nextButton.dataset.originalBackground = computedStyle.backgroundColor || '#1e40af';
              nextButton.dataset.originalBorder = computedStyle.border || '';
              nextButton.dataset.originalColor = computedStyle.color || '';
            }
            
            console.log(`â° [DEBUG] ì›ë˜ ìŠ¤íƒ€ì¼ ì €ì¥:`, {
              background: nextButton.dataset.originalBackground,
              border: nextButton.dataset.originalBorder,
              color: nextButton.dataset.originalColor
            });
          }
          
          // í™ˆ ë²„íŠ¼ì˜ ê²½ìš° ìƒ‰ìƒ ì¡°ì •
          let baseColor = '#6b7280'; // íšŒìƒ‰ (í™ˆ ë²„íŠ¼ìš©)
          let targetColor = '#1e40af'; // íŒŒë€ìƒ‰ (í™ˆ ë²„íŠ¼ìš©)
          
          // ë‹¤ë¥¸ í˜ì´ì§€ì˜ ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ìƒ‰ìƒ
          if (!nextButton.textContent.includes('í™ˆìœ¼ë¡œ')) {
            baseColor = '#6b7280'; // ê¸°ë³¸ íšŒìƒ‰
            targetColor = '#1e40af'; // ê¸°ë³¸ íŒŒë€ìƒ‰
          }
          
          // ë¶€ë“œëŸ¬ìš´ ê·¸ë¼ë°ì´ì…˜ìœ¼ë¡œ ì™¼ìª½ë¶€í„° ì±„ìš°ê¸°
          nextButton.style.background = `linear-gradient(
            to right, 
            ${targetColor} 0%, 
            ${targetColor} ${progress}%, 
            ${baseColor} ${progress}%, 
            ${baseColor} 100%
          )`;
          
          // ë¶€ë“œëŸ¬ìš´ ì „í™˜ íš¨ê³¼ ì¶”ê°€
          nextButton.style.transition = 'background 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
          nextButton.style.backgroundSize = '100% 100%';
          nextButton.style.backgroundRepeat = 'no-repeat';
          
          console.log(`â° [DEBUG] í”„ë¡œê·¸ë ˆìŠ¤ ë²„íŠ¼ ì—…ë°ì´íŠ¸: ${nextButton.textContent}, ì§„í–‰ë„: ${progress.toFixed(1)}% (${baseColor}â†’${targetColor})`);
        } else {
          console.log(`â° [DEBUG] ë‹¤ìŒ/í™ˆ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ ë˜ëŠ” ìë™ ì§„í–‰ ë¹„í™œì„±í™”`);
        }
      }

      function autoGoToNextPage() {
        console.log(`â° [AUTO] ìë™ìœ¼ë¡œ ë‹¤ìŒ í˜ì´ì§€ ì´ë™`);
        
        // ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ ë²„íŠ¼ ì°¾ê¸° (í™ˆ ë²„íŠ¼ í¬í•¨)
        const nextButton = document.querySelector('.nav-btn.next-btn') || 
                          document.querySelector('.navigation-button.next') ||
                          document.querySelector('button[onclick*="next()"]') ||
                          document.querySelector('.page19-home-btn') || // page19 í™ˆ ë²„íŠ¼
                          document.querySelector('button[onclick*="goHome()"]'); // goHome ë²„íŠ¼
                          
        console.log(`â° [DEBUG] ìë™ í´ë¦­í•  ë²„íŠ¼:`, nextButton);
        
        if (nextButton && !nextButton.disabled) {
          nextButton.click();
        } else {
          // ë²„íŠ¼ì„ ëª» ì°¾ìœ¼ë©´ ì§ì ‘ í•¨ìˆ˜ í˜¸ì¶œ
          const currentPage = getCurrentPageName();
          if (currentPage === 'page19' && typeof window.goHome === 'function') {
            window.goHome();
            console.log(`â° [AUTO] goHome() ì§ì ‘ í˜¸ì¶œ`);
          } else if (window.app && typeof window.app.next === 'function') {
            window.app.next();
            console.log(`â° [AUTO] app.next() ì§ì ‘ í˜¸ì¶œ`);
          }
        }
      }

      function clearAutoProgress() {
        if (autoProgressTimer) {
          clearTimeout(autoProgressTimer);
          autoProgressTimer = null;
        }
        
        if (countdownTimer) {
          clearInterval(countdownTimer);
          countdownTimer = null;
        }
        
        isAutoProgressActive = false;
        currentCountdown = 0;
        
        // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ë³µêµ¬ (ë¶€ë“œëŸ¬ìš´ ì „í™˜ íš¨ê³¼ í¬í•¨)
        const nextButton = document.querySelector('.nav-btn.next-btn') || 
                          document.querySelector('.navigation-button.next') ||
                          document.querySelector('button[onclick*="next()"]') ||
                          document.querySelector('.page19-home-btn') || // page19 í™ˆ ë²„íŠ¼
                          document.querySelector('button[onclick*="goHome()"]'); // goHome ë²„íŠ¼
                          
        if (nextButton) {
          // ì›ë˜ í…ìŠ¤íŠ¸ë¡œ ë³µêµ¬ (í™ˆ ë²„íŠ¼ì€ "í™ˆìœ¼ë¡œ" ìœ ì§€)
          let baseText = 'ë‹¤ìŒ>';
          if (nextButton.classList.contains('page19-home-btn') || nextButton.textContent.includes('í™ˆìœ¼ë¡œ')) {
            baseText = 'í™ˆìœ¼ë¡œ';
          } else if (nextButton.textContent.includes('>')) {
            baseText = 'ë‹¤ìŒ>';
          } else {
            baseText = 'ë‹¤ìŒ';
          }
          nextButton.textContent = baseText;
          
          // ë¶€ë“œëŸ¬ìš´ ìŠ¤íƒ€ì¼ ë³µêµ¬
          if (nextButton.dataset.originalBackground) {
            // ë¶€ë“œëŸ¬ìš´ ì „í™˜ìœ¼ë¡œ ì›ë˜ ìƒ‰ìƒìœ¼ë¡œ ë³µêµ¬
            nextButton.style.transition = 'background 0.5s ease-out';
            nextButton.style.background = nextButton.dataset.originalBackground;
            console.log(`â° [DEBUG] ë¶€ë“œëŸ¬ìš´ ë°°ê²½ìƒ‰ ë³µêµ¬: ${nextButton.dataset.originalBackground}`);
          } else {
            // ê¸°ë³¸ ìŠ¤íƒ€ì¼ë¡œë§Œ ì´ˆê¸°í™”
            nextButton.style.background = '';
          }
          
          // í”„ë¡œê·¸ë ˆìŠ¤ ê´€ë ¨ ìŠ¤íƒ€ì¼ ì •ë¦¬ (ì§€ì—° ì‹¤í–‰ìœ¼ë¡œ ë¶€ë“œëŸ¬ìš´ íš¨ê³¼)
          setTimeout(() => {
            nextButton.style.backgroundSize = '';
            nextButton.style.backgroundRepeat = '';
            nextButton.style.transition = '';
          }, 500);
          
          console.log(`â° [DEBUG] ë²„íŠ¼ ìŠ¤íƒ€ì¼ ë¶€ë“œëŸ½ê²Œ ë³µêµ¬: ${nextButton.textContent}`);
        }
        
        console.log(`â° [AUTO] ìë™ ì§„í–‰ ì‹œìŠ¤í…œ ì •ë¦¬ ì™„ë£Œ`);
      }

      function getCurrentPageName() {
        return window.app?.getCurrentScreen?.() || 'home';
      }

      // ê°„ë‹¨í•œ page3 ìŒì„± í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
      function testPage3Voice() {
        console.log('ğŸ§ª [TEST] page3 ìŒì„± í…ŒìŠ¤íŠ¸ ì‹œì‘');
        
        // ì§ì ‘ ì˜¤ë””ì˜¤ ê°ì²´ ìƒì„±í•˜ì—¬ í…ŒìŠ¤íŠ¸
        const testAudio = new Audio('assets/voices/voice_page3.mp3');
        testAudio.volume = 0.8;
        
        testAudio.addEventListener('loadeddata', () => {
          console.log('ğŸ§ª [TEST] ìŒì„± íŒŒì¼ ë¡œë“œ ì„±ê³µ');
        });
        
        testAudio.addEventListener('error', (e) => {
          console.error('ğŸ§ª [TEST] ìŒì„± íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨:', e);
          console.error('ğŸ§ª [TEST] íŒŒì¼ ê²½ë¡œ:', testAudio.src);
        });
        
        testAudio.play().then(() => {
          console.log('ğŸ§ª [TEST] âœ… ìŒì„± ì¬ìƒ ì„±ê³µ!');
        }).catch(error => {
          console.error('ğŸ§ª [TEST] âŒ ìŒì„± ì¬ìƒ ì‹¤íŒ¨:', error);
        });
        
        // ì „ì—­ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡
        window.testAudio = testAudio;
      }

      // í˜ì´ì§€ë³„ ìŒì„± ê°€ì´ë“œ ì¬ìƒ (ìŒì†Œê±° ìƒíƒœ í™•ì¸ ì¶”ê°€)
      function playVoiceForPage(pageName) {
        console.log(`ğŸ™ï¸ [DEBUG] playVoiceForPage í˜¸ì¶œë¨: ${pageName}`);
        console.log(`ğŸ™ï¸ [DEBUG] userHasInteracted: ${userHasInteracted}`);
        console.log(`ğŸ™ï¸ [DEBUG] isVoiceEnabled: ${isVoiceEnabled}`);
        console.log(`ğŸ™ï¸ [DEBUG] VOICE_SCRIPTS[${pageName}]: ${VOICE_SCRIPTS[pageName]}`);
        console.log(`ğŸ™ï¸ [DEBUG] voiceAudio ê°ì²´: ${!!voiceAudio}`);
        
        // ì‚¬ìš©ì ìƒí˜¸ì‘ìš© ì²´í¬ë¥¼ ì¼ì‹œì ìœ¼ë¡œ ë¹„í™œì„±í™” (í…ŒìŠ¤íŠ¸ìš©)
        console.log(`ğŸ™ï¸ [INFO] ì‚¬ìš©ì ìƒí˜¸ì‘ìš© ì²´í¬ ê±´ë„ˆë›°ê¸° (í…ŒìŠ¤íŠ¸ ëª¨ë“œ)`);
        
        // ìŒì„± ê°€ì´ë“œ í™œì„±í™” ìƒíƒœ í™•ì¸
        if (!isVoiceEnabled) {
          console.log(`ğŸ™ï¸ ìŒì„± ê°€ì´ë“œ ë¹„í™œì„±í™”ë¨`);
          return;
        }
        
        // ë°°ê²½ìŒì•… ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸ (ìŒì†Œê±° ìƒíƒœì¼ ë•Œ ìŒì„±ë„ ë¹„í™œì„±í™”)
        if (window.backgroundMusicSystem && !window.backgroundMusicSystem.isEnabled()) {
          console.log(`ğŸ™ï¸ ìŒì†Œê±° ìƒíƒœë¡œ ì¸í•´ ìŒì„± ê°€ì´ë“œ ê±´ë„ˆë›°ê¸°`);
          return;
        }
        
        // í™ˆ ë™ì˜ìƒ ìŒì†Œê±° ìƒíƒœ í™•ì¸
        const homeVideo = document.getElementById('homeBackgroundVideo');
        if (homeVideo && homeVideo.muted) {
          console.log(`ğŸ™ï¸ í™ˆ ë™ì˜ìƒ ìŒì†Œê±°ë¡œ ì¸í•´ ìŒì„± ê°€ì´ë“œ ê±´ë„ˆë›°ê¸°`);
          return;
        }
        
        if (!VOICE_SCRIPTS[pageName]) {
          console.log(`ğŸ™ï¸ ìŒì„± ê°€ì´ë“œ ì—†ìŒ: ${pageName}`);
          return;
        }

        if (!voiceAudio) {
          console.error(`ğŸ™ï¸ [ERROR] voiceAudio ê°ì²´ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•ŠìŒ`);
          return;
        }

        const voiceFile = VOICE_SCRIPTS[pageName];
        console.log(`ğŸ™ï¸ [DEBUG] ìŒì„± íŒŒì¼ ê²½ë¡œ: ${voiceFile}`);
        
        // ì´ì „ ìŒì„± ì •ì§€
        if (isVoicePlaying) {
          console.log(`ğŸ™ï¸ [DEBUG] ì´ì „ ìŒì„± ì •ì§€`);
          stopVoice();
        }

        // ë°°ê²½ìŒì•… ë³¼ë¥¨ ì¤„ì´ê¸°
        lowerBackgroundMusicVolume();

        // ìŒì„± íŒŒì¼ ë¡œë“œ ë° ì¬ìƒ
        voiceAudio.src = voiceFile;
        console.log(`ğŸ™ï¸ [DEBUG] ìŒì„± íŒŒì¼ src ì„¤ì • ì™„ë£Œ: ${voiceAudio.src}`);
        
        // ì•½ê°„ì˜ ì§€ì—° í›„ ì¬ìƒ ì‹œë„
        setTimeout(() => {
          voiceAudio.play().then(() => {
            isVoicePlaying = true;
            console.log(`ğŸ™ï¸ âœ… ìŒì„± ê°€ì´ë“œ ì¬ìƒ ì‹œì‘: ${pageName}`);
          }).catch(error => {
            console.error(`ğŸ™ï¸ âŒ ìŒì„± ê°€ì´ë“œ ì¬ìƒ ì‹¤íŒ¨: ${pageName}`, error);
            console.error(`ğŸ™ï¸ [ERROR] íŒŒì¼ ê²½ë¡œ: ${voiceFile}`);
            console.error(`ğŸ™ï¸ [ERROR] ìƒì„¸ ì˜¤ë¥˜:`, error.message);
            restoreBackgroundMusicVolume();
          });
        }, 100);
      }

      // ìŒì„± ê°€ì´ë“œ ì •ì§€
      function stopVoice() {
        if (voiceAudio) {
          voiceAudio.pause();
          voiceAudio.currentTime = 0;
          isVoicePlaying = false;
          restoreBackgroundMusicVolume();
          console.log('ğŸ™ï¸ ìŒì„± ê°€ì´ë“œ ì •ì§€');
        }
      }

      // ìŒì„± ê°€ì´ë“œ í† ê¸€
      function toggleVoiceGuide() {
        isVoiceEnabled = !isVoiceEnabled;
        if (!isVoiceEnabled && isVoicePlaying) {
          stopVoice();
        }
        console.log(`ğŸ™ï¸ ìŒì„± ê°€ì´ë“œ ${isVoiceEnabled ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}`);
        return isVoiceEnabled;
      }

      // ë°°ê²½ìŒì•… ë³¼ë¥¨ ì¤„ì´ê¸° (ìŒì„± ì¬ìƒ ì¤‘)
      function lowerBackgroundMusicVolume() {
        if (backgroundAudio && isMusicEnabled) {
          backgroundAudio.volume = 0.3; // 30%ë¡œ ì¤„ì„
          console.log('ğŸ”‰ ë°°ê²½ìŒì•… ë³¼ë¥¨ ê°ì†Œ (ìŒì„± ì¬ìƒ ì¤‘)');
        }
      }

      // ë°°ê²½ìŒì•… ë³¼ë¥¨ ë³µêµ¬
      function restoreBackgroundMusicVolume() {
        if (backgroundAudio && isMusicEnabled) {
          backgroundAudio.volume = 1.0; // ì›ë˜ ë³¼ë¥¨ìœ¼ë¡œ ë³µêµ¬
          console.log('ğŸ”Š ë°°ê²½ìŒì•… ë³¼ë¥¨ ë³µêµ¬');
        }
      }

      // ë°°ê²½ ìŒì•… í† ê¸€ í•¨ìˆ˜ (ë°±ì—… ë²„ì „ê³¼ ë™ì¼í•œ ê°„ë‹¨í•œ ë¡œì§)
      function toggleBackgroundMusic() {
        console.log('ğŸ”Š toggleBackgroundMusic í•¨ìˆ˜ í˜¸ì¶œë¨');
        console.log('ğŸ”Š í˜„ì¬ ìƒíƒœ:', { isMusicEnabled, backgroundAudio: !!backgroundAudio });
        
        if (isMusicEnabled) {
          // ìŒì•… ë„ê¸°
          if (backgroundAudio) {
            backgroundAudio.pause();
          }
          isMusicEnabled = false;
          console.log('ğŸ”‡ ë°°ê²½ ìŒì•… ë¹„í™œì„±í™”');
        } else {
          // ìŒì•… ì¼œê¸°
          isMusicEnabled = true;
          if (backgroundAudio) {
            backgroundAudio.play().then(() => {
              console.log('ğŸµ ë°°ê²½ ìŒì•… í™œì„±í™”');
            }).catch(error => {
              console.warn('ë°°ê²½ ìŒì•… ì¬ìƒ ì‹¤íŒ¨:', error);
            });
          }
        }
        
        // ì•„ì´ì½˜ ì—…ë°ì´íŠ¸
        const soundToggle = document.getElementById('soundToggle');
        if (soundToggle) {
          soundToggle.textContent = isMusicEnabled ? "ğŸ”Š" : "ğŸ”‡";
        }
        
        return isMusicEnabled;
      }

      // ì „ì—­ì— í•¨ìˆ˜ ë…¸ì¶œ (í•¨ìˆ˜ ì •ì˜ ì§í›„ ë°”ë¡œ ì‹¤í–‰)
      window.toggleBackgroundMusic = toggleBackgroundMusic;
      
      // ë” ì´ìƒ í™ˆ ë™ì˜ìƒê³¼ ë™ê¸°í™”í•˜ì§€ ì•ŠìŒ (ë°°ê²½ìŒì•…ë§Œ ë…ë¦½ ì œì–´)
      function syncMusicWithHomeVideo() {
        console.log('ğŸ”„ [INFO] í™ˆ ë™ì˜ìƒê³¼ ë°°ê²½ìŒì•…ì€ ì´ì œ ë…ë¦½ì ìœ¼ë¡œ ì‘ë™');
        return isMusicEnabled;
      }
      
      // ì‚¬ìš©ì ìƒí˜¸ì‘ìš© í›„ ìë™ ìŒì•… ì‹œì‘ (ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€ ê°•í™”)
      function startBackgroundMusicOnInteraction() {
        console.log('ğŸµ [INTERACTION] ì‚¬ìš©ì ìƒí˜¸ì‘ìš©ìœ¼ë¡œ ìŒì•… ì‹œì‘ ì‹œë„');
        
        // ì´ë¯¸ ìŒì•…ì´ ì¬ìƒ ì¤‘ì´ë©´ ì ˆëŒ€ ê±´ë“œë¦¬ì§€ ì•ŠìŒ
        if (backgroundAudio && !backgroundAudio.paused) {
          console.log('ğŸµ ë°°ê²½ ìŒì•…ì´ ì´ë¯¸ ì¬ìƒ ì¤‘ - ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠìŒ');
          return;
        }
        
        // ìŒì•…ì´ í™œì„±í™” ìƒíƒœì´ê³  ì •ì§€ë˜ì–´ ìˆì„ ë•Œë§Œ ì‹œì‘
        if (isMusicEnabled && backgroundAudio && backgroundAudio.paused) {
          console.log('ğŸµ [INTERACTION] ìŒì•… ì‹œì‘ ê°€ëŠ¥ - ì¬ìƒ ì‹œë„');
          backgroundAudio.play().then(() => {
            console.log('ğŸµ [INTERACTION] ë°°ê²½ ìŒì•… ì‹œì‘ ì„±ê³µ');
          }).catch(error => {
            console.warn('ğŸµ [INTERACTION] ë°°ê²½ ìŒì•… ì‹œì‘ ì‹¤íŒ¨:', error);
          });
        } else {
          console.log('ğŸµ [INTERACTION] ìŒì•… ë¹„í™œì„±í™” ë˜ëŠ” ì´ë¯¸ ì¬ìƒ ì¤‘ - ê±´ë„ˆë›°ê¸°');
        }
      }

      // í™ˆ í™”ë©´ ë™ì˜ìƒ ì˜¤ë””ì˜¤ ìŒì†Œê±° í•¨ìˆ˜
      function muteHomeVideo() {
        setTimeout(() => {
          const homeVideo = document.getElementById('homeBackgroundVideo');
          if (homeVideo) {
            homeVideo.muted = true; // í™ˆ ë™ì˜ìƒ ìŒì†Œê±°
            homeVideo.volume = 0;
            console.log('ğŸ”‡ í™ˆ í™”ë©´ ë™ì˜ìƒ ì˜¤ë””ì˜¤ ìŒì†Œê±°');
            
            // ë°°ê²½ ìŒì•…ë„ í•¨ê»˜ ë¹„í™œì„±í™”
            syncMusicWithHomeVideo();
          }
        }, 1000);
      }

      window.updateFullscreenButton = function(isFullscreen) {
        const fullscreenBtn = document.getElementById('fullscreenToggle');
        if (!fullscreenBtn) return;
        
        if (isFullscreen) {
          fullscreenBtn.innerHTML = `
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M5 16H8V14H5V16ZM8 8H5V10H8V8ZM14 19H16V16H14V19ZM16 8V5H14V8H16ZM14 14H16V16H14V14ZM8 10H10V8H8V10ZM10 14V16H8V14H10ZM16 10H14V8H16V10Z" fill="currentColor"/>
            </svg>
          `;
          fullscreenBtn.title = 'ì „ì²´í™”ë©´ í•´ì œ';
        } else {
          fullscreenBtn.innerHTML = `
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M7 14H5V19H10V17H7V14Z" fill="currentColor"/>
              <path d="M5 10H7V7H10V5H5V10Z" fill="currentColor"/>
              <path d="M17 14H19V19H14V17H17V14Z" fill="currentColor"/>
              <path d="M14 5V7H17V10H19V5H14Z" fill="currentColor"/>
            </svg>
          `;
          fullscreenBtn.title = 'ì „ì²´í™”ë©´ ëª¨ë“œ';
        }
      };

      // ì „ì²´í™”ë©´ ìƒíƒœ ë³€ê²½ ê°ì§€ (íƒœë¸”ë¦¿ ìµœì í™” ê°œì„ )
      window.handleFullscreenChange = function() {
        const isFullscreen = !!(document.fullscreenElement || 
                               document.webkitFullscreenElement || 
                               document.mozFullScreenElement || 
                               document.msFullscreenElement);
        
        console.log(`ğŸ–¥ï¸ ì „ì²´í™”ë©´ ìƒíƒœ ë³€ê²½ ì´ë²¤íŠ¸: ${isFullscreen ? 'í™œì„±í™”' : 'í•´ì œ'}`);
        window.updateFullscreenButton(isFullscreen);
        
        if (isFullscreen) {
          document.body.classList.add('fullscreen-mode');
          
          // íƒœë¸”ë¦¿ ìµœì í™”: 1280x800 ê¸°ì¤€ìœ¼ë¡œ í™”ë©´ì— ë§ê²Œ ìŠ¤ì¼€ì¼ ê³„ì‚°
          const targetWidth = 1280;
          const targetHeight = 800;
          
          // ì‹¤ì œ ë·°í¬íŠ¸ í¬ê¸° ì‚¬ìš© (ë¸Œë¼ìš°ì € UI ì œì™¸)
          const viewportWidth = window.innerWidth;
          const viewportHeight = window.innerHeight;
          
          console.log(`ğŸ–¥ï¸ ë·°í¬íŠ¸ í¬ê¸°: ${viewportWidth}x${viewportHeight}`);
          console.log(`ğŸ–¥ï¸ íƒ€ê²Ÿ í¬ê¸°: ${targetWidth}x${targetHeight}`);
          
          // íƒœë¸”ë¦¿ì—ì„œ ì¢Œìš°ë¥¼ í™”ë©´ì— ë”± ë§ê²Œ: ê°€ë¡œ ê¸°ì¤€ìœ¼ë¡œ ìŠ¤ì¼€ì¼ ê²°ì •
          let scale;
          
          // íƒœë¸”ë¦¿ì¸ì§€ í™•ì¸ (ì¼ë°˜ì ì¸ íƒœë¸”ë¦¿ í•´ìƒë„ ë²”ìœ„)
          const isTablet = (viewportWidth >= 768 && viewportWidth <= 1366) && 
                          (viewportHeight >= 600 && viewportHeight <= 1024);
          
          if (isTablet) {
            // íƒœë¸”ë¦¿: í™”ë©´ì„ ì™„ì „íˆ ê½‰ ì±„ìš°ê¸° ìœ„í•´ ë” í° ìŠ¤ì¼€ì¼ ì„ íƒ
            const scaleX = viewportWidth / targetWidth;
            const scaleY = viewportHeight / targetHeight;
            scale = Math.max(scaleX, scaleY); // ë” í° ìŠ¤ì¼€ì¼ë¡œ ì—¬ë°± ì™„ì „ ì œê±°
            console.log(`ğŸ–¥ï¸ íƒœë¸”ë¦¿ ëª¨ë“œ: max(${scaleX.toFixed(3)}, ${scaleY.toFixed(3)}) = ${scale.toFixed(3)} (í™”ë©´ ì™„ì „íˆ ì±„ìš°ê¸°)`);
            console.log(`ğŸ–¥ï¸ [DEBUG] í™”ë©´ í¬ê¸°: ${viewportWidth}x${viewportHeight}, íƒ€ê²Ÿ: ${targetWidth}x${targetHeight}`);
          } else {
            // ë°ìŠ¤í¬í†±: ê¸°ì¡´ ë°©ì‹ (ë¹„ìœ¨ ìœ ì§€í•˜ë©´ì„œ ì „ì²´ í™”ë©´ ë§ì¶¤)
            const scaleX = viewportWidth / targetWidth;
            const scaleY = viewportHeight / targetHeight;
            scale = Math.min(scaleX, scaleY);
            console.log(`ğŸ–¥ï¸ ë°ìŠ¤í¬í†± ëª¨ë“œ: min(${scaleX.toFixed(3)}, ${scaleY.toFixed(3)}) = ${scale.toFixed(3)}`);
          }
          
          // ìµœì†Œ ìŠ¤ì¼€ì¼ ë³´ì¥ (ë„ˆë¬´ ì‘ì•„ì§€ì§€ ì•Šë„ë¡)
          scale = Math.max(scale, 0.8);
          
          console.log(`ğŸ–¥ï¸ ìµœì¢… ìŠ¤ì¼€ì¼: ${scale.toFixed(3)} (${isTablet ? 'íƒœë¸”ë¦¿' : 'ë°ìŠ¤í¬í†±'} ëª¨ë“œ)`);
          
          // CSS ë³€ìˆ˜ë¡œ ìŠ¤ì¼€ì¼ ê°’ ì„¤ì •
          document.documentElement.style.setProperty('--fullscreen-scale', scale);
          
          // íƒœë¸”ë¦¿ì—ì„œ ì¶”ê°€ ìŠ¤ì¼€ì¼ë§ í™•ì¸ì„ ìœ„í•œ ë””ë²„ê¹…
          if (isTablet) {
            console.log(`ğŸ–¥ï¸ [DEBUG] íƒœë¸”ë¦¿ ì „ì²´í™”ë©´ ëª¨ë“œ í™œì„±í™”`);
            console.log(`ğŸ–¥ï¸ [DEBUG] ê³„ì‚°ëœ ìŠ¤ì¼€ì¼: ${scale}`);
            console.log(`ğŸ–¥ï¸ [DEBUG] CSS ë³€ìˆ˜ ì„¤ì •: --fullscreen-scale = ${scale}`);
            
            // ìŠ¤ì¼€ì¼ì´ ì œëŒ€ë¡œ ì ìš©ë˜ëŠ”ì§€ í™•ì¸
            setTimeout(() => {
              const screenContainer = document.querySelector('.screen-container');
              if (screenContainer) {
                const computedStyle = window.getComputedStyle(screenContainer);
                console.log(`ğŸ–¥ï¸ [DEBUG] ì‹¤ì œ ì ìš©ëœ transform:`, computedStyle.transform);
                console.log(`ğŸ–¥ï¸ [DEBUG] ì»¨í…Œì´ë„ˆ í¬ê¸°:`, {
                  width: screenContainer.offsetWidth,
                  height: screenContainer.offsetHeight
                });
              }
            }, 100);
          }
        } else {
          document.body.classList.remove('fullscreen-mode');
          // ìŠ¤ì¼€ì¼ ì´ˆê¸°í™”
          document.documentElement.style.removeProperty('--fullscreen-scale');
        }
      };

      // ì „ì²´í™”ë©´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
      document.addEventListener('fullscreenchange', window.handleFullscreenChange);
      document.addEventListener('webkitfullscreenchange', window.handleFullscreenChange);
      document.addEventListener('mozfullscreenchange', window.handleFullscreenChange);
      document.addEventListener('MSFullscreenChange', window.handleFullscreenChange);

      // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ ì¶”ê°€ ì„¤ì • (fullscreen-test.html ë°©ì‹)
      window.addEventListener('load', function() {
        console.log('ğŸ–¥ï¸ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ - ì „ì²´í™”ë©´ í•¨ìˆ˜ í™•ì¸');
        console.log('ğŸ–¥ï¸ window.toggleFullscreen:', typeof window.toggleFullscreen);
        
        // ì „ì²´í™”ë©´ ì§€ì› í™•ì¸
        const elem = document.documentElement;
        const support = elem.requestFullscreen ? 'Standard API âœ…' :
                       elem.webkitRequestFullscreen ? 'WebKit API âœ…' :
                       elem.mozRequestFullScreen ? 'Mozilla API âœ…' :
                       elem.msRequestFullscreen ? 'MS API âœ…' : 'Not Supported âŒ';
        console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ì§€ì›:', support);
      });
      
      // ì „ì²´í™”ë©´ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
      window.testFullscreen = function() {
        console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹œì‘');
        console.log('ğŸ–¥ï¸ ë¸Œë¼ìš°ì € ì§€ì› ì—¬ë¶€:', {
          requestFullscreen: !!document.documentElement.requestFullscreen,
          webkitRequestFullscreen: !!document.documentElement.webkitRequestFullscreen,
          mozRequestFullScreen: !!document.documentElement.mozRequestFullScreen,
          msRequestFullscreen: !!document.documentElement.msRequestFullscreen
        });
        
        const fullscreenBtn = document.getElementById('fullscreenToggle');
        console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ë²„íŠ¼ ì¡´ì¬:', !!fullscreenBtn);
        
        if (fullscreenBtn) {
          console.log('ğŸ–¥ï¸ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ìˆ˜ë™ ë°œìƒ');
          fullscreenBtn.click();
        }
      };

      // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ ìë™ ì´ˆê¸°í™” ë° ì¬ìƒ
      window.addEventListener('load', () => {
        console.log('ğŸ¬ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ - ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹œì‘');
        
        initBackgroundMusic();
        initVoiceGuide(); // ìŒì„± ê°€ì´ë“œ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
        // muteHomeVideo(); // ìë™ ìŒì†Œê±° ì œê±° - ì‚¬ìš©ìê°€ ì§ì ‘ ì œì–´í•˜ë„ë¡ ë³€ê²½
        
        // ğŸ”Š ì‚¬ìš´ë“œ í† ê¸€ ë²„íŠ¼ ì´ˆê¸° ìƒíƒœ ì„¤ì •
        setTimeout(() => {
          const soundToggle = document.getElementById('soundToggle');
          if (soundToggle) {
            soundToggle.textContent = isMusicEnabled ? "ğŸ”Š" : "ğŸ”‡";
            console.log('ğŸ”Š ì‚¬ìš´ë“œ í† ê¸€ ë²„íŠ¼ ì´ˆê¸° ìƒíƒœ ì„¤ì •:', isMusicEnabled ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”');
          }
        }, 1000);
        
        // ì „ì²´í™”ë©´ ë²„íŠ¼ ì´ˆê¸° ìƒíƒœ ì„¤ì •
        updateFullscreenButton(false);
        
        // ğŸ–¥ï¸ í‚¤ì˜¤ìŠ¤í¬ ëª¨ë“œ: ê¸°ë³¸ ì „ì²´í™”ë©´ ì„¤ì •
        initKioskMode();
        
        // ğŸ–¥ï¸ ì „ì²´í™”ë©´ ë²„íŠ¼ í™•ì¸ (í™ˆ í™”ë©´ ë¡œë“œ í›„)
        setTimeout(() => {
          const fullscreenBtn = document.getElementById('fullscreenToggle');
          console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ë²„íŠ¼ ì¡´ì¬ ì—¬ë¶€:', !!fullscreenBtn);
          console.log('ğŸ–¥ï¸ window.toggleFullscreen í•¨ìˆ˜:', typeof window.toggleFullscreen);
          
          if (fullscreenBtn) {
            console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ë²„íŠ¼ onclick ì†ì„±:', fullscreenBtn.getAttribute('onclick'));
            
            // ìˆ˜ë™ìœ¼ë¡œ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            fullscreenBtn.addEventListener('click', function(e) {
              console.log('ğŸ–¥ï¸ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ê°ì§€ë¨!');
              e.preventDefault();
              if (typeof window.toggleFullscreen === 'function') {
                window.toggleFullscreen();
              } else {
                console.error('ğŸ–¥ï¸ toggleFullscreen í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
              }
            });
            console.log('ğŸ–¥ï¸ âœ… ì „ì²´í™”ë©´ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ ì™„ë£Œ');
          } else {
            console.error('ğŸ–¥ï¸ âŒ ì „ì²´í™”ë©´ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ');
          }
        }, 2000); // í™ˆ í™”ë©´ ë¡œë“œ í›„ 2ì´ˆ ëŒ€ê¸°            // ì‚¬ìš©ì ìƒí˜¸ì‘ìš© ê°ì§€ (ë²„íŠ¼ í´ë¦­, í„°ì¹˜, í‚¤ë³´ë“œ ë“±)
            const interactionEvents = ['click', 'touchstart', 'keydown'];
            
            function markUserInteraction() {
              if (!userHasInteracted) {
                userHasInteracted = true;
                console.log('ğŸ‘† ì‚¬ìš©ì ìƒí˜¸ì‘ìš© ê°ì§€ë¨ - ìŒì„± ì¬ìƒ ê°€ëŠ¥');
              }
            }
            
            // ìƒí˜¸ì‘ìš© ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
            interactionEvents.forEach(event => {
              document.addEventListener(event, markUserInteraction, { once: true });
            });        
            
        // ì²« ë²ˆì§¸ í´ë¦­ì´ë‚˜ í„°ì¹˜ì—ì„œ ìŒì•… ìë™ ì‹œì‘ (ì¤‘ë³µ ë°©ì§€ ê°•í™”)
        if (!musicInteractionListenerAdded) {
          // í•œ ë²ˆë§Œ ì‹¤í–‰ë˜ëŠ” ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (once: true)
          const interactionHandler = () => {
            console.log('ğŸµ [ONCE] ì²« ë²ˆì§¸ ì‚¬ìš©ì ìƒí˜¸ì‘ìš© ê°ì§€');
            // ì´ë¯¸ ìŒì•…ì´ ì¬ìƒ ì¤‘ì´ ì•„ë‹ ë•Œë§Œ ì‹œì‘
            if (backgroundAudio && backgroundAudio.paused && isMusicEnabled) {
              startBackgroundMusicOnInteraction();
            }
            musicInteractionListenerAdded = true; // ì™„ì „íˆ ì²˜ë¦¬ëœ í›„ í”Œë˜ê·¸ ì„¤ì •
          };
          
          document.addEventListener('click', interactionHandler, { once: true });
          document.addEventListener('touchstart', interactionHandler, { once: true });
          console.log('ğŸµ ìŒì•… ìƒí˜¸ì‘ìš© ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ë¨ (once: true)');
        }
      });

      // ğŸ–¥ï¸ í‚¤ì˜¤ìŠ¤í¬ ëª¨ë“œ ì´ˆê¸°í™” (ë§¥ë¶ í¬ë¡¬ í˜¸í™˜ ë²„ì „)
      function initKioskMode() {
        console.log('ğŸ–¥ï¸ í‚¤ì˜¤ìŠ¤í¬ ëª¨ë“œ ì´ˆê¸°í™” ì‹œì‘ (ì•ˆì „ ëª¨ë“œ)');
        
        // ì „ì²´í™”ë©´ ì§€ì› ì—¬ë¶€ í™•ì¸
        const elem = document.documentElement;
        const fullscreenSupported = !!(elem.requestFullscreen || 
                                      elem.webkitRequestFullscreen || 
                                      elem.mozRequestFullScreen || 
                                      elem.msRequestFullscreen);
        
        console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ì§€ì›:', fullscreenSupported);
        
        if (!fullscreenSupported) {
          console.warn('ğŸ–¥ï¸ âš ï¸ ì´ ë¸Œë¼ìš°ì €ëŠ” ì „ì²´í™”ë©´ APIë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤');
          // ì „ì²´í™”ë©´ ë²„íŠ¼ ë¹„í™œì„±í™”
          const fullscreenBtn = document.getElementById('fullscreenToggle');
          if (fullscreenBtn) {
            fullscreenBtn.style.opacity = '0.5';
            fullscreenBtn.style.cursor = 'not-allowed';
            fullscreenBtn.title = 'ì „ì²´í™”ë©´ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤';
          }
        }
        
        // í™”ë©´ íšŒì „ ì ê¸ˆ (ëª¨ë°”ì¼ì—ì„œë§Œ)
        if (window.innerWidth <= 1024 && screen.orientation && screen.orientation.lock) {
          screen.orientation.lock('landscape').catch(err => {
            console.log('ğŸ”„ í™”ë©´ íšŒì „ ì ê¸ˆ ì‹¤íŒ¨ (ê¶Œí•œ í•„ìš”):', err);
          });
        }
        
        // ë”ë¸”íƒ­ ì¤Œ ë°©ì§€ (ëª¨ë°”ì¼ì—ì„œë§Œ)
        if (window.innerWidth <= 1024) {
          let lastTouchEnd = 0;
          document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
              event.preventDefault();
            }
            lastTouchEnd = now;
          }, false);
        }
        
        // F11í‚¤ë¡œ ì „ì²´í™”ë©´ í† ê¸€ (ë°ìŠ¤í¬í†±ì—ì„œë§Œ)
        if (window.innerWidth > 1024) {
          document.addEventListener('keydown', function(e) {
            if (e.key === 'F11') {
              e.preventDefault();
              toggleFullscreen();
            }
          });
        }
        
        console.log('ğŸ–¥ï¸ í‚¤ì˜¤ìŠ¤í¬ ëª¨ë“œ ì„¤ì • ì™„ë£Œ (ì•ˆì „ ëª¨ë“œ)');
      }

      // ì „ì²´í™”ë©´ ìš”ì²­ (ê°„ì†Œí™”ëœ ë²„ì „)
      function requestFullscreenMode() {
        if (!document.fullscreenElement) {
          const elem = document.documentElement;
          
          console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ëª¨ë“œ ìš”ì²­ ì‹œì‘...');
          
          if (elem.requestFullscreen) {
            elem.requestFullscreen().then(() => {
              console.log('ğŸ–¥ï¸ âœ… ì „ì²´í™”ë©´ ëª¨ë“œ í™œì„±í™”');
            }).catch(err => {
              console.log('ğŸ–¥ï¸ âŒ ì „ì²´í™”ë©´ ìš”ì²­ ì‹¤íŒ¨:', err);
            });
          } else if (elem.webkitRequestFullscreen) { // Safari
            elem.webkitRequestFullscreen();
          } else if (elem.msRequestFullscreen) { // IE/Edge
            elem.msRequestFullscreen();
          } else if (elem.mozRequestFullScreen) { // Firefox
            elem.mozRequestFullScreen();
          }
        }
      }
      
      // 5ì´ˆ í›„ ë™ì˜ìƒ ìƒíƒœ í™•ì¸
      setTimeout(() => {
        const video = document.getElementById('homeBackgroundVideo');
        console.log('ğŸ¬ ë™ì˜ìƒ ìš”ì†Œ:', video);
        if (video) {
          console.log('ğŸ¬ ë™ì˜ìƒ src:', video.src);
          console.log('ğŸ¬ ë™ì˜ìƒ readyState:', video.readyState);
          console.log('ğŸ¬ ë™ì˜ìƒ networkState:', video.networkState);
        }
        
        const videoContainer = document.querySelector('.home-video-container');
        console.log('ğŸ¬ ë™ì˜ìƒ ì»¨í…Œì´ë„ˆ:', videoContainer);
        
        // ë°°ê²½ ìŒì•… ìƒíƒœ í™•ì¸
        console.log('ğŸµ ë°°ê²½ ìŒì•… ìƒíƒœ:', {
          currentTrack: currentAudioIndex,
          volume: backgroundAudio?.volume,
          src: backgroundAudio?.src
        });
      }, 5000);
      
      // í™”ë©´ í¬ê¸° ë””ë²„ê·¸ ì •ë³´ ì—…ë°ì´íŠ¸
      function updateScreenSizeDebug() {
        const screenContainer = document.querySelector('.screen-container');
        const screenSizeElement = document.getElementById('screenSize');
        if (screenContainer && screenSizeElement) {
          const width = screenContainer.offsetWidth;
          const height = screenContainer.offsetHeight;
          const isFullscreen = document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement;
          screenSizeElement.textContent = `${width}x${height} ${isFullscreen ? '(ì „ì²´í™”ë©´)' : '(ì¼ë°˜í™”ë©´)'}`;
        }
      }
      
      // ì´ˆê¸° í¬ê¸° í‘œì‹œ
      updateScreenSizeDebug();
      
      // ì „ì²´í™”ë©´ ë³€ê²½ ê°ì§€
      document.addEventListener('fullscreenchange', updateScreenSizeDebug);
      document.addEventListener('webkitfullscreenchange', updateScreenSizeDebug);
      document.addEventListener('mozfullscreenchange', updateScreenSizeDebug);
      document.addEventListener('MSFullscreenChange', updateScreenSizeDebug);
      
      // ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ ê°ì§€
      window.addEventListener('resize', updateScreenSizeDebug);
      
      // ì£¼ê¸°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ (ì¶”ê°€ ì•ˆì „ì¥ì¹˜)
      setInterval(updateScreenSizeDebug, 1000);
    </script>

    <!-- ï¿½ URLì—ì„œ ë””ë°”ì´ìŠ¤ ID ì¶”ì¶œ -->
    <script>
      // URL ê²½ë¡œì—ì„œ ë””ë°”ì´ìŠ¤ ID ì¶”ì¶œ (ì˜ˆ: /TABLET_01)
      function getDeviceIdFromUrl() {
        console.log('ğŸ” URL ê²½ë¡œì—ì„œ ë””ë°”ì´ìŠ¤ ID ì¶”ì¶œ ì‹œë„');
        const path = window.location.pathname;
        console.log('ğŸ” í˜„ì¬ URL ê²½ë¡œ:', path);
        
        // ê²½ë¡œê°€ ë‹¨ìˆœ ìŠ¬ë˜ì‹œë‚˜ index.htmlì¸ ê²½ìš° ì œì™¸
        if (path === '/' || path === '/index.html') {
          console.log('ğŸ” ê¸°ë³¸ ê²½ë¡œ - ë””ë°”ì´ìŠ¤ ID ì¶”ì¶œ ê±´ë„ˆë›°ê¸°');
          return null;
        }
        
        // ê²½ë¡œì—ì„œ ìŠ¬ë˜ì‹œ ì œê±°í•˜ê³  ID ì¶”ì¶œ
        const deviceId = path.replace(/^\//, '').replace(/\/index\.html$/, '');
        
        if (deviceId) {
          console.log('ğŸ” URLì—ì„œ ë””ë°”ì´ìŠ¤ ID ì¶”ì¶œë¨:', deviceId);
          
          // localStorageì— ID ì €ì¥
          localStorage.setItem('dunlopillo_device_id', deviceId);
          localStorage.setItem('dunlopillo_auto_device_id', deviceId);
          
          console.log('ğŸ” ë””ë°”ì´ìŠ¤ ID ì €ì¥ë¨:', deviceId);
          return deviceId;
        }
        
        return null;
      }
      
      // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì‹¤í–‰
      window.addEventListener('DOMContentLoaded', () => {
        getDeviceIdFromUrl();
      });
    </script>
    
    <!-- ï¿½ğŸš€ PWA Service Worker ë“±ë¡ -->
    <script>
      // Service Worker ë“±ë¡
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/service-worker.js')
            .then((registration) => {
              console.log('âœ… Service Worker ë“±ë¡ ì„±ê³µ:', registration.scope);
              
              // ì—…ë°ì´íŠ¸ ê°ì§€
              registration.addEventListener('updatefound', () => {
                console.log('ğŸ”„ Service Worker ì—…ë°ì´íŠ¸ ê°ì§€');
                const newWorker = registration.installing;
                
                newWorker.addEventListener('statechange', () => {
                  if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                    console.log('ğŸ†• ìƒˆ ë²„ì „ ì‚¬ìš© ê°€ëŠ¥ - í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ê¶Œì¥');
                    
                    // ìë™ ì—…ë°ì´íŠ¸ (ì„ íƒì )
                    if (confirm('ìƒˆ ë²„ì „ì´ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. ì§€ê¸ˆ ì—…ë°ì´íŠ¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                      newWorker.postMessage({ type: 'SKIP_WAITING' });
                      window.location.reload();
                    }
                  }
                });
              });
            })
            .catch((error) => {
              console.error('âŒ Service Worker ë“±ë¡ ì‹¤íŒ¨:', error);
            });
        });

        // Service Worker ë©”ì‹œì§€ ìˆ˜ì‹ 
        navigator.serviceWorker.addEventListener('message', (event) => {
          if (event.data && event.data.type === 'SW_UPDATED') {
            window.location.reload();
          }
        });
      } else {
        console.warn('âš ï¸ Service Workerë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤');
      }

      // ì˜¤í”„ë¼ì¸/ì˜¨ë¼ì¸ ìƒíƒœ ê°ì§€
      window.addEventListener('online', () => {
        console.log('ğŸŒ ì˜¨ë¼ì¸ ìƒíƒœ');
        showConnectionStatus('ì˜¨ë¼ì¸', '#4CAF50');
      });

      window.addEventListener('offline', () => {
        console.log('ğŸ“¡ ì˜¤í”„ë¼ì¸ ìƒíƒœ');
        showConnectionStatus('ì˜¤í”„ë¼ì¸ ëª¨ë“œ', '#FF9800');
      });

      function showConnectionStatus(message, color) {
        const statusDiv = document.createElement('div');
        statusDiv.textContent = message;
        statusDiv.style.cssText = `
          position: fixed;
          top: 20px;
          left: 50%;
          transform: translateX(-50%);
          background: ${color};
          color: white;
          padding: 8px 16px;
          border-radius: 20px;
          font-size: 14px;
          font-weight: bold;
          z-index: 10000;
          animation: slideDown 0.3s ease;
        `;
        
        document.body.appendChild(statusDiv);
        
        setTimeout(() => {
          statusDiv.style.animation = 'slideUp 0.3s ease';
          setTimeout(() => statusDiv.remove(), 300);
        }, 3000);
      }

      // CSS ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€
      const style = document.createElement('style');
      style.textContent = `
        @keyframes slideDown {
          from { transform: translateX(-50%) translateY(-100%); opacity: 0; }
          to { transform: translateX(-50%) translateY(0); opacity: 1; }
        }
        @keyframes slideUp {
          from { transform: translateX(-50%) translateY(0); opacity: 1; }
          to { transform: translateX(-50%) translateY(-100%); opacity: 0; }
        }
      `;
      document.head.appendChild(style);
    </script>
  </body>
</html>
