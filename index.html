<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover, minimal-ui" />
    <meta charset="utf-8" />
    
    <!-- ëª¨ë°”ì¼ ìµœì í™” ë©”íƒ€ íƒœê·¸ -->
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- PWA ë§¤ë‹ˆí˜ìŠ¤íŠ¸ -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1e40af">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-fullscreen">
    <meta name="apple-mobile-web-app-title" content="ë˜ë¡­í•„ë¡œ SPA">
    
    <!-- í°íŠ¸ ìµœì í™”: font-display ì ìš© ë° CDN í°íŠ¸ ì§ì ‘ ë¡œë”© -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preload" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css"></noscript>
    
    <!-- ë©”ì¸ ìŠ¤íƒ€ì¼ì‹œíŠ¸ -->
    <link rel="stylesheet" href="styles.css" />
    <title>Dunlopillo SPA</title>
  </head>
  <body>
    <!-- ê¸€ë¡œë²Œ êµ¬ì¡°: ì „ì²´ ë°”íƒ•(ì°í•œ íšŒìƒ‰) + í™”ë©´(1280x800 ì˜…ì€ íšŒìƒ‰) -->
    <div class="screen-container" id="app">
      <!-- ì—¬ê¸°ì— ê° í˜ì´ì§€ ì»¨í…ì¸ ê°€ ë Œë”ë§ë©ë‹ˆë‹¤ -->
    </div>
    
    <!-- JavaScript íŒŒì¼ë“¤ - ìˆœì„œ ì¤‘ìš”! -->
    <script src="survey-data-manager.js"></script>
    <script src="survey-data.js"></script>
    <script src="screens.js"></script>
    <script src="script.js"></script>
    
    <!-- ë°°ê²½ ìŒì•… ì‹œìŠ¤í…œ (ìë™ ì¬ìƒ) -->
    <audio id="backgroundAudio" loop preload="auto" style="display: none;">
      <source src="https://res.cloudinary.com/di2pd92t1/video/upload/v1748237173/Dunlopillo-Crash-Test-Flexibilitet-web_n045ph.mp4" type="audio/mp4">
      <source src="https://res.cloudinary.com/di2pd92t1/video/upload/v1748237657/Dunlopillo-Crash-Test-Stabilitet-web_mvxr27.mp4" type="audio/mp4">
    </audio>
    
    <!-- ë””ë²„ê¹…ìš© ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ -->
    <script>
      console.log('ğŸ“ HTML ë¡œë”© ì™„ë£Œ');
      console.log('ğŸ” screens ê°ì²´ í™•ì¸:', typeof window.screens);
      console.log('ğŸ” surveyData ê°ì²´ í™•ì¸:', typeof window.surveyData);
      
      // ë™ì˜ìƒ ë””ë²„ê¹…
      console.log('ğŸ¬ VIDEO_SOURCES í™•ì¸:', window.VIDEO_SOURCES);
      console.log('ğŸ¬ USE_VIDEO_BACKGROUND í™•ì¸:', window.USE_VIDEO_BACKGROUND);
      
      // ğŸ–¥ï¸ ì „ì²´í™”ë©´ í•¨ìˆ˜ë“¤ì„ ê°€ì¥ ë¨¼ì € ì •ì˜ (ì „ì—­ ì ‘ê·¼ ê°€ëŠ¥)
      function toggleFullscreen() {
        console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ í† ê¸€ í•¨ìˆ˜ í˜¸ì¶œë¨!');
        
        const elem = document.documentElement;
        
        // í˜„ì¬ ì „ì²´í™”ë©´ ìƒíƒœ í™•ì¸
        const isFullscreen = !!(document.fullscreenElement || document.webkitFullscreenElement);
        console.log('ğŸ–¥ï¸ í˜„ì¬ ì „ì²´í™”ë©´ ìƒíƒœ:', isFullscreen);
        
        if (isFullscreen) {
          // ì „ì²´í™”ë©´ í•´ì œ (ì•ˆì „í•˜ê²Œ)
          console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ í•´ì œ ì‹œë„');
          if (document.exitFullscreen) {
            document.exitFullscreen().catch(err => {
              console.warn('ğŸ–¥ï¸ ì „ì²´í™”ë©´ í•´ì œ ì‹¤íŒ¨:', err);
            });
          } else if (document.webkitExitFullscreen) {
            document.webkitExitFullscreen();
          }
        } else {
          // ì „ì²´í™”ë©´ ì§„ì… (ì•ˆì „í•˜ê²Œ)
          console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ì§„ì… ì‹œë„');
          
          // ë§¥ë¶ í¬ë¡¬ í˜¸í™˜ì„ ìœ„í•œ ì•ˆì „í•œ ìš”ì²­
          if (elem.requestFullscreen) {
            elem.requestFullscreen().catch(err => {
              console.warn('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ì§„ì… ì‹¤íŒ¨:', err);
              // navigationUI ì˜µì…˜ ì—†ì´ ì¬ì‹œë„
              elem.requestFullscreen().catch(err2 => {
                console.error('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ì§„ì… ì™„ì „ ì‹¤íŒ¨:', err2);
              });
            });
          } else if (elem.webkitRequestFullscreen) {
            // Safari/Chrome êµ¬í˜• ë²„ì „ ì§€ì›
            elem.webkitRequestFullscreen();
          }
        }
      }
      
      // ì „ì—­ìœ¼ë¡œ ë“±ë¡
      window.toggleFullscreen = toggleFullscreen;
      
      window.updateFullscreenButton = function(isFullscreen) {
        console.log('ğŸ–¥ï¸ ë²„íŠ¼ ì—…ë°ì´íŠ¸:', isFullscreen ? 'ì „ì²´í™”ë©´ ëª¨ë“œ' : 'ì¼ë°˜ ëª¨ë“œ');
        
        const fullscreenBtn = document.getElementById('fullscreenToggle');
        if (!fullscreenBtn) {
          console.warn('ğŸ–¥ï¸ âš ï¸ ì „ì²´í™”ë©´ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
          return;
        }
        
        try {
          if (isFullscreen) {
            fullscreenBtn.innerHTML = `
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M5 16H8V14H5V16ZM8 8H5V10H8V8ZM14 19H16V16H14V19ZM16 8V5H14V8H16ZM14 14H16V16H14V14ZM8 10H10V8H8V10ZM10 14V16H8V14H10ZM16 10H14V8H16V10Z" fill="currentColor"/>
              </svg>
            `;
            fullscreenBtn.title = 'ì „ì²´í™”ë©´ í•´ì œ';
          } else {
            fullscreenBtn.innerHTML = `
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M7 14H5V19H10V17H7V14Z" fill="currentColor"/>
                <path d="M5 10H7V7H10V5H5V10Z" fill="currentColor"/>
                <path d="M17 14H19V19H14V17H17V14Z" fill="currentColor"/>
                <path d="M14 5V7H17V10H19V5H14Z" fill="currentColor"/>
              </svg>
            `;
            fullscreenBtn.title = 'ì „ì²´í™”ë©´ ëª¨ë“œ';
          }
          console.log('ğŸ–¥ï¸ âœ… ë²„íŠ¼ ì•„ì´ì½˜ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
        } catch (error) {
          console.error('ğŸ–¥ï¸ âŒ ë²„íŠ¼ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
        }
      };
      
      // ì „ì²´í™”ë©´ ìƒíƒœ ë³€ê²½ ê°ì§€
      window.handleFullscreenChange = function() {
        const isFullscreen = !!(document.fullscreenElement || 
                               document.webkitFullscreenElement || 
                               document.mozFullScreenElement || 
                               document.msFullscreenElement);
        
        console.log(`ğŸ–¥ï¸ ì „ì²´í™”ë©´ ìƒíƒœ ë³€ê²½ ì´ë²¤íŠ¸: ${isFullscreen ? 'í™œì„±í™”' : 'í•´ì œ'}`);
        window.updateFullscreenButton(isFullscreen);
        
        if (isFullscreen) {
          document.body.classList.add('fullscreen-mode');
        } else {
          document.body.classList.remove('fullscreen-mode');
        }
      };
      
      // ì „ì²´í™”ë©´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
      document.addEventListener('fullscreenchange', window.handleFullscreenChange);
      document.addEventListener('webkitfullscreenchange', window.handleFullscreenChange);
      document.addEventListener('mozfullscreenchange', window.handleFullscreenChange);
      document.addEventListener('MSFullscreenChange', window.handleFullscreenChange);
      
      console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ í•¨ìˆ˜ë“¤ì´ ì „ì—­ìœ¼ë¡œ ì •ì˜ë˜ì—ˆìŠµë‹ˆë‹¤');
      
      // ğŸµ ë°°ê²½ ìŒì•… ìë™ ì¬ìƒ ì‹œìŠ¤í…œ
      let backgroundAudio = null;
      let currentAudioIndex = 0;
      let isMusicEnabled = true; // ìŒì•… í™œì„±í™” ìƒíƒœ (ì „ì—­ ìœ ì§€)
      
      // ğŸ™ï¸ AI ìŒì„± ê°€ì´ë“œ ì‹œìŠ¤í…œ (í•œ ë²ˆë§Œ ì„ ì–¸)
      let voiceAudio = null;
      let isVoiceEnabled = true;
      let isVoicePlaying = false;
      let userHasInteracted = false; // ì‚¬ìš©ì ìƒí˜¸ì‘ìš© í™•ì¸
      
      // â° ìë™ ì§„í–‰ ì‹œìŠ¤í…œ
      let autoProgressTimer = null;
      let countdownTimer = null;
      let currentCountdown = 0;
      let isAutoProgressActive = false;
      
      // ë°°ê²½ ìŒì•… ì†ŒìŠ¤ë“¤ (ë™ì˜ìƒì—ì„œ ì˜¤ë””ì˜¤ë§Œ ì¶”ì¶œ)
      const BACKGROUND_AUDIO_SOURCES = [
        'https://res.cloudinary.com/di2pd92t1/video/upload/v1748237173/Dunlopillo-Crash-Test-Flexibilitet-web_n045ph.mp4',
        'https://res.cloudinary.com/di2pd92t1/video/upload/v1748237657/Dunlopillo-Crash-Test-Stabilitet-web_mvxr27.mp4',
        'https://res.cloudinary.com/di2pd92t1/video/upload/v1748241410/Dunlopillo-Crash-Test-Allergivenlig-A%CC%8Andba%CC%8Ar-web_wxolsb.mp4'
      ];

      // í˜ì´ì§€ë³„ ìŒì„± íŒŒì¼ ë§¤í•‘ (ì‹¤ì œ ë¡œì»¬ íŒŒì¼ ê¸°ì¤€)
      const VOICE_SCRIPTS = {
        'page3': 'assets/voices/voice_page3.mp3',
        'page4': 'assets/voices/voice_page4.mp3', 
        'page5': 'assets/voices/voice_page5.mp3',
        'page7': 'assets/voices/voice_page7.mp3',
        'page8': 'assets/voices/voice_page8.mp3',
        'page10': 'assets/voices/voice_page10.mp3',
        'page11': 'assets/voices/voice_page11.mp3',
        'page12': 'assets/voices/voice_page12.mp3',
        'page13': 'assets/voices/voice_page13.mp3',
        'page15': 'assets/voices/voice_page15.mp3',
        'page17': 'assets/voices/voice_page17.mp3'
      };

      // ì „ì—­ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
      window.VOICE_SCRIPTS = VOICE_SCRIPTS;

      // â° ìë™ ì§„í–‰ ì„¤ì • (í˜ì´ì§€ë³„)
      const AUTO_PROGRESS_CONFIG = {
        // ìŒì„± ì•ˆë‚´ ìˆëŠ” í˜ì´ì§€ë“¤ (ìŒì„± ì¢…ë£Œ í›„ 5ì´ˆ)
        'page3': { hasVoice: true, delay: 9 },
        'page4': { hasVoice: true, delay: 9 },
        'page5': { hasVoice: true, delay: 5 },  // ë³„ì 1
        'page7': { hasVoice: true, delay: 9 },
        'page8': { hasVoice: true, delay: 5 }, // ë³„ì 2
        'page10': { hasVoice: true, delay: 5 },
        'page11': { hasVoice: true, delay: 120 }, // 2ë¶„ ëŒ€ê¸°
        'page12': { hasVoice: true, delay: 5 }, // ë³„ì 3
        'page13': { hasVoice: true, delay: 9 }, // ì œë¡œì§€
        'page15': { hasVoice: true, delay: 9 },
        'page17': { hasVoice: true, delay: 30 },
        
        // ìŒì„± ì•ˆë‚´ ì—†ëŠ” í˜ì´ì§€ë“¤ (7ì´ˆ í›„ ìë™ ì§„í–‰) - page3ë¶€í„° ì‹œì‘
        'page6': { hasVoice: false, delay: 7 },
        'page9': { hasVoice: false, delay: 7 },
        'page14': { hasVoice: false, delay: 7 },
        'page16': { hasVoice: false, delay: 7 },
        'page18': { hasVoice: false, delay: 5 },
        'page19': { hasVoice: false, delay: 7 },
        'page20': { hasVoice: false, delay: 7 }
        // page1, page2ëŠ” ìë™ ì§„í–‰ ì—†ìŒ
      };

      function initBackgroundMusic() {
        // ë°°ê²½ ìŒì•… ìš”ì†Œ ìƒì„±
        backgroundAudio = document.createElement('audio');
        backgroundAudio.loop = false; // ê°œë³„ íŠ¸ë™ì´ ëë‚˜ë©´ ë‹¤ìŒìœ¼ë¡œ
        backgroundAudio.volume = 1.0; // ìµœëŒ€ ë³¼ë¥¨ (100%)
        backgroundAudio.preload = 'auto';
        
        // ì²« ë²ˆì§¸ ì†ŒìŠ¤ ì„¤ì •
        backgroundAudio.src = BACKGROUND_AUDIO_SOURCES[currentAudioIndex];
        
        // íŠ¸ë™ ì¢…ë£Œ ì‹œ ë‹¤ìŒ íŠ¸ë™ìœ¼ë¡œ ìë™ ì „í™˜
        backgroundAudio.addEventListener('ended', () => {
          currentAudioIndex = (currentAudioIndex + 1) % BACKGROUND_AUDIO_SOURCES.length;
          backgroundAudio.src = BACKGROUND_AUDIO_SOURCES[currentAudioIndex];
          if (isMusicEnabled) {
            backgroundAudio.play().catch(error => {
              console.warn('ë‹¤ìŒ íŠ¸ë™ ì¬ìƒ ì‹¤íŒ¨:', error);
            });
          }
        });
        
        // ì „ì—­ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
        window.backgroundMusicSystem = {
          audio: backgroundAudio,
          toggle: toggleBackgroundMusic,
          isEnabled: () => isMusicEnabled,
          syncWithHomeVideo: syncMusicWithHomeVideo
        };
        
        console.log('ğŸµ ë°°ê²½ ìŒì•… ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ');
      }

      // ğŸ™ï¸ AI ìŒì„± ê°€ì´ë“œ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
      function initVoiceGuide() {
        voiceAudio = document.createElement('audio');
        voiceAudio.volume = 0.8; // ìŒì„±ì€ ë°°ê²½ìŒì•…ë³´ë‹¤ í¬ê²Œ
        voiceAudio.preload = 'auto';
        
        // ìŒì„± ë¡œë”© ì™„ë£Œ
        voiceAudio.addEventListener('loadeddata', () => {
          console.log('ğŸ™ï¸ [DEBUG] ìŒì„± íŒŒì¼ ë¡œë“œ ì™„ë£Œ:', voiceAudio.src);
        });

        // ìŒì„± ë¡œë”© ì‹œì‘
        voiceAudio.addEventListener('loadstart', () => {
          console.log('ğŸ™ï¸ [DEBUG] ìŒì„± íŒŒì¼ ë¡œë”© ì‹œì‘:', voiceAudio.src);
        });
        
        // ìŒì„± ì¬ìƒ ì™„ë£Œ ì‹œ ë°°ê²½ìŒì•… ë³µêµ¬ + ìë™ ì§„í–‰ ì‹œì‘
        voiceAudio.addEventListener('ended', () => {
          isVoicePlaying = false;
          restoreBackgroundMusicVolume();
          console.log('ğŸ™ï¸ ìŒì„± ê°€ì´ë“œ ì¬ìƒ ì™„ë£Œ');
          
          // ìŒì„± ì¢…ë£Œ í›„ ìë™ ì§„í–‰ ì‹œì‘
          const currentPage = getCurrentPageName();
          const config = AUTO_PROGRESS_CONFIG[currentPage];
          if (config && config.hasVoice) {
            console.log(`â° [AUTO] ìŒì„± ì¢…ë£Œ â†’ ìë™ ì§„í–‰ ì‹œì‘ (${config.delay}ì´ˆ)`);
            startCountdown(config.delay);
          }
        });

        // ìŒì„± ì¬ìƒ ì˜¤ë¥˜ ì²˜ë¦¬
        voiceAudio.addEventListener('error', (e) => {
          console.error('ğŸ™ï¸ âŒ ìŒì„± ê°€ì´ë“œ ì¬ìƒ ì‹¤íŒ¨:', e);
          console.error('ğŸ™ï¸ [ERROR] ì˜¤ë¥˜ ì½”ë“œ:', voiceAudio.error?.code);
          console.error('ğŸ™ï¸ [ERROR] ì˜¤ë¥˜ ë©”ì‹œì§€:', voiceAudio.error?.message);
          console.error('ğŸ™ï¸ [ERROR] íŒŒì¼ ê²½ë¡œ:', voiceAudio.src);
          isVoicePlaying = false;
          restoreBackgroundMusicVolume();
        });

        // ì „ì—­ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
        window.voiceGuideSystem = {
          audio: voiceAudio,
          playVoiceForPage: playVoiceForPage,
          stopVoice: stopVoice,
          isEnabled: () => isVoiceEnabled,
          toggle: toggleVoiceGuide
        };

        // â° ìë™ ì§„í–‰ ì‹œìŠ¤í…œë„ ì „ì—­ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
        window.startAutoProgress = startAutoProgress;
        window.clearAutoProgress = clearAutoProgress;
        window.AUTO_PROGRESS_CONFIG = AUTO_PROGRESS_CONFIG;

        console.log('ğŸ™ï¸ AI ìŒì„± ê°€ì´ë“œ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ');
      }

      // â° ìë™ ì§„í–‰ ì‹œìŠ¤í…œ
      function startAutoProgress(pageName) {
        console.log(`â° [AUTO] ìë™ ì§„í–‰ ì‹œì‘: ${pageName}`);
        
        // ê¸°ì¡´ íƒ€ì´ë¨¸ë“¤ ì •ë¦¬
        clearAutoProgress();
        
        const config = AUTO_PROGRESS_CONFIG[pageName];
        if (!config) {
          console.log(`â° [AUTO] ìë™ ì§„í–‰ ì„¤ì • ì—†ìŒ: ${pageName}`);
          return;
        }

        isAutoProgressActive = true;
        
        if (config.hasVoice && VOICE_SCRIPTS[pageName]) {
          // ìŒì„± ì•ˆë‚´ í˜ì´ì§€: ìŒì„± ì¢…ë£Œ í›„ ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘
          console.log(`â° [AUTO] ìŒì„± ì¢…ë£Œ ëŒ€ê¸° ì¤‘...`);
          // ìŒì„± ì¢…ë£ŒëŠ” voiceAudioì˜ 'ended' ì´ë²¤íŠ¸ì—ì„œ ì²˜ë¦¬
        } else {
          // ì¼ë°˜ í˜ì´ì§€: ì¦‰ì‹œ ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘
          startCountdown(config.delay);
        }
      }

      function startCountdown(seconds) {
        if (!isAutoProgressActive) return;
        
        console.log(`â° [AUTO] ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘: ${seconds}ì´ˆ`);
        currentCountdown = seconds;
        updateNextButtonText();
        
        countdownTimer = setInterval(() => {
          currentCountdown--;
          updateNextButtonText();
          
          if (currentCountdown <= 0) {
            clearAutoProgress();
            autoGoToNextPage();
          }
        }, 1000);
      }

      function updateNextButtonText() {
        // ë‹¤ì–‘í•œ ë²„íŠ¼ í´ë˜ìŠ¤ ì‹œë„
        const nextButton = document.querySelector('.nav-btn.next-btn') || 
                          document.querySelector('.navigation-button.next') ||
                          document.querySelector('button[onclick*="next()"]') ||
                          document.querySelector('button:contains("ë‹¤ìŒ")');
                          
        console.log(`â° [DEBUG] ë‹¤ìŒ ë²„íŠ¼ ì°¾ê¸°:`, nextButton);
        
        if (nextButton && isAutoProgressActive) {
          const originalText = nextButton.textContent.includes('ë‹¤ìŒ') ? 'ë‹¤ìŒ>' : 'ë‹¤ìŒ';
          // íƒ€ì´ë¨¸ í…ìŠ¤íŠ¸ ì œê±° - ì›ë˜ í…ìŠ¤íŠ¸ë§Œ ìœ ì§€
          nextButton.textContent = originalText;
          
          // ë¶€ë“œëŸ¬ìš´ ì„ í˜• í”„ë¡œê·¸ë ˆìŠ¤ íš¨ê³¼ (ì´ì „ ë²„íŠ¼ ìƒ‰ â†’ ë‹¤ìŒ ë²„íŠ¼ ìƒ‰)
          const totalSeconds = AUTO_PROGRESS_CONFIG[getCurrentPageName()]?.delay || 7;
          const progress = ((totalSeconds - currentCountdown) / totalSeconds) * 100;
          
          // ê¸°ì¡´ ë°°ê²½ìƒ‰ì„ í•œ ë²ˆë§Œ ì €ì¥
          if (!nextButton.dataset.originalBackground) {
            const computedStyle = window.getComputedStyle(nextButton);
            nextButton.dataset.originalBackground = computedStyle.backgroundColor || '#1e40af';
            nextButton.dataset.originalBorder = computedStyle.border || '';
            nextButton.dataset.originalColor = computedStyle.color || '';
            console.log(`â° [DEBUG] ì›ë˜ ìŠ¤íƒ€ì¼ ì €ì¥:`, {
              background: nextButton.dataset.originalBackground,
              border: nextButton.dataset.originalBorder,
              color: nextButton.dataset.originalColor
            });
          }
          
          // ì´ì „ ë²„íŠ¼ ìƒ‰ìƒ(íšŒìƒ‰)ì—ì„œ ë‹¤ìŒ ë²„íŠ¼ ìƒ‰ìƒ(íŒŒë€ìƒ‰)ìœ¼ë¡œ ì±„ìš°ê¸°
          const prevButtonColor = '#6b7280'; // ì´ì „ ë²„íŠ¼ íšŒìƒ‰ (#primary-gray)
          const nextButtonColor = '#1e40af'; // ë‹¤ìŒ ë²„íŠ¼ íŒŒë€ìƒ‰ (#primary-blue)
          
          // ë¶€ë“œëŸ¬ìš´ ê·¸ë¼ë°ì´ì…˜ìœ¼ë¡œ ì™¼ìª½ë¶€í„° ì±„ìš°ê¸°
          nextButton.style.background = `linear-gradient(
            to right, 
            ${nextButtonColor} 0%, 
            ${nextButtonColor} ${progress}%, 
            ${prevButtonColor} ${progress}%, 
            ${prevButtonColor} 100%
          )`;
          
          // ë¶€ë“œëŸ¬ìš´ ì „í™˜ íš¨ê³¼ ì¶”ê°€
          nextButton.style.transition = 'background 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
          nextButton.style.backgroundSize = '100% 100%';
          nextButton.style.backgroundRepeat = 'no-repeat';
          
          console.log(`â° [DEBUG] í”„ë¡œê·¸ë ˆìŠ¤ ë²„íŠ¼ ì—…ë°ì´íŠ¸: ${nextButton.textContent}, ì§„í–‰ë„: ${progress.toFixed(1)}% (íšŒìƒ‰â†’íŒŒë€ìƒ‰)`);
        } else {
          console.log(`â° [DEBUG] ë‹¤ìŒ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ ë˜ëŠ” ìë™ ì§„í–‰ ë¹„í™œì„±í™”`);
        }
      }

      function autoGoToNextPage() {
        console.log(`â° [AUTO] ìë™ìœ¼ë¡œ ë‹¤ìŒ í˜ì´ì§€ ì´ë™`);
        
        // ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ ë‹¤ìŒ ë²„íŠ¼ ì°¾ê¸°
        const nextButton = document.querySelector('.nav-btn.next-btn') || 
                          document.querySelector('.navigation-button.next') ||
                          document.querySelector('button[onclick*="next()"]');
                          
        console.log(`â° [DEBUG] ìë™ í´ë¦­í•  ë²„íŠ¼:`, nextButton);
        
        if (nextButton && !nextButton.disabled) {
          nextButton.click();
        } else {
          // ë²„íŠ¼ì„ ëª» ì°¾ìœ¼ë©´ ì§ì ‘ next() í•¨ìˆ˜ í˜¸ì¶œ
          if (window.app && typeof window.app.next === 'function') {
            window.app.next();
            console.log(`â° [AUTO] app.next() ì§ì ‘ í˜¸ì¶œ`);
          }
        }
      }

      function clearAutoProgress() {
        if (autoProgressTimer) {
          clearTimeout(autoProgressTimer);
          autoProgressTimer = null;
        }
        
        if (countdownTimer) {
          clearInterval(countdownTimer);
          countdownTimer = null;
        }
        
        isAutoProgressActive = false;
        currentCountdown = 0;
        
        // ë‹¤ìŒ ë²„íŠ¼ ìŠ¤íƒ€ì¼ ë³µêµ¬ (ë¶€ë“œëŸ¬ìš´ ì „í™˜ íš¨ê³¼ í¬í•¨)
        const nextButton = document.querySelector('.nav-btn.next-btn') || 
                          document.querySelector('.navigation-button.next') ||
                          document.querySelector('button[onclick*="next()"]');
                          
        if (nextButton) {
          // ì›ë˜ í…ìŠ¤íŠ¸ë¡œ ë³µêµ¬
          const baseText = nextButton.textContent.includes('>') ? 'ë‹¤ìŒ>' : 'ë‹¤ìŒ';
          nextButton.textContent = baseText;
          
          // ë¶€ë“œëŸ¬ìš´ ìŠ¤íƒ€ì¼ ë³µêµ¬
          if (nextButton.dataset.originalBackground) {
            // ë¶€ë“œëŸ¬ìš´ ì „í™˜ìœ¼ë¡œ ì›ë˜ ìƒ‰ìƒìœ¼ë¡œ ë³µêµ¬
            nextButton.style.transition = 'background 0.5s ease-out';
            nextButton.style.background = nextButton.dataset.originalBackground;
            console.log(`â° [DEBUG] ë¶€ë“œëŸ¬ìš´ ë°°ê²½ìƒ‰ ë³µêµ¬: ${nextButton.dataset.originalBackground}`);
          } else {
            // ê¸°ë³¸ ìŠ¤íƒ€ì¼ë¡œë§Œ ì´ˆê¸°í™”
            nextButton.style.background = '';
          }
          
          // í”„ë¡œê·¸ë ˆìŠ¤ ê´€ë ¨ ìŠ¤íƒ€ì¼ ì •ë¦¬ (ì§€ì—° ì‹¤í–‰ìœ¼ë¡œ ë¶€ë“œëŸ¬ìš´ íš¨ê³¼)
          setTimeout(() => {
            nextButton.style.backgroundSize = '';
            nextButton.style.backgroundRepeat = '';
            nextButton.style.transition = '';
          }, 500);
          
          console.log(`â° [DEBUG] ë²„íŠ¼ ìŠ¤íƒ€ì¼ ë¶€ë“œëŸ½ê²Œ ë³µêµ¬: ${nextButton.textContent}`);
        }
        
        console.log(`â° [AUTO] ìë™ ì§„í–‰ ì‹œìŠ¤í…œ ì •ë¦¬ ì™„ë£Œ`);
      }

      function getCurrentPageName() {
        return window.app?.getCurrentScreen?.() || 'home';
      }

      // ê°„ë‹¨í•œ page3 ìŒì„± í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
      function testPage3Voice() {
        console.log('ğŸ§ª [TEST] page3 ìŒì„± í…ŒìŠ¤íŠ¸ ì‹œì‘');
        
        // ì§ì ‘ ì˜¤ë””ì˜¤ ê°ì²´ ìƒì„±í•˜ì—¬ í…ŒìŠ¤íŠ¸
        const testAudio = new Audio('assets/voices/voice_page3.mp3');
        testAudio.volume = 0.8;
        
        testAudio.addEventListener('loadeddata', () => {
          console.log('ğŸ§ª [TEST] ìŒì„± íŒŒì¼ ë¡œë“œ ì„±ê³µ');
        });
        
        testAudio.addEventListener('error', (e) => {
          console.error('ğŸ§ª [TEST] ìŒì„± íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨:', e);
          console.error('ğŸ§ª [TEST] íŒŒì¼ ê²½ë¡œ:', testAudio.src);
        });
        
        testAudio.play().then(() => {
          console.log('ğŸ§ª [TEST] âœ… ìŒì„± ì¬ìƒ ì„±ê³µ!');
        }).catch(error => {
          console.error('ğŸ§ª [TEST] âŒ ìŒì„± ì¬ìƒ ì‹¤íŒ¨:', error);
        });
        
        // ì „ì—­ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡
        window.testAudio = testAudio;
      }

      // í˜ì´ì§€ë³„ ìŒì„± ê°€ì´ë“œ ì¬ìƒ (ìˆ˜ì •ëœ ë²„ì „)
      function playVoiceForPage(pageName) {
        console.log(`ğŸ™ï¸ [DEBUG] playVoiceForPage í˜¸ì¶œë¨: ${pageName}`);
        console.log(`ğŸ™ï¸ [DEBUG] userHasInteracted: ${userHasInteracted}`);
        console.log(`ğŸ™ï¸ [DEBUG] isVoiceEnabled: ${isVoiceEnabled}`);
        console.log(`ğŸ™ï¸ [DEBUG] VOICE_SCRIPTS[${pageName}]: ${VOICE_SCRIPTS[pageName]}`);
        console.log(`ğŸ™ï¸ [DEBUG] voiceAudio ê°ì²´: ${!!voiceAudio}`);
        
        // ì‚¬ìš©ì ìƒí˜¸ì‘ìš© ì²´í¬ë¥¼ ì¼ì‹œì ìœ¼ë¡œ ë¹„í™œì„±í™” (í…ŒìŠ¤íŠ¸ìš©)
        console.log(`ğŸ™ï¸ [INFO] ì‚¬ìš©ì ìƒí˜¸ì‘ìš© ì²´í¬ ê±´ë„ˆë›°ê¸° (í…ŒìŠ¤íŠ¸ ëª¨ë“œ)`);
        
        if (!isVoiceEnabled) {
          console.log(`ğŸ™ï¸ ìŒì„± ê°€ì´ë“œ ë¹„í™œì„±í™”ë¨`);
          return;
        }
        
        if (!VOICE_SCRIPTS[pageName]) {
          console.log(`ğŸ™ï¸ ìŒì„± ê°€ì´ë“œ ì—†ìŒ: ${pageName}`);
          return;
        }

        if (!voiceAudio) {
          console.error(`ğŸ™ï¸ [ERROR] voiceAudio ê°ì²´ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•ŠìŒ`);
          return;
        }

        const voiceFile = VOICE_SCRIPTS[pageName];
        console.log(`ğŸ™ï¸ [DEBUG] ìŒì„± íŒŒì¼ ê²½ë¡œ: ${voiceFile}`);
        
        // ì´ì „ ìŒì„± ì •ì§€
        if (isVoicePlaying) {
          console.log(`ğŸ™ï¸ [DEBUG] ì´ì „ ìŒì„± ì •ì§€`);
          stopVoice();
        }

        // ë°°ê²½ìŒì•… ë³¼ë¥¨ ì¤„ì´ê¸°
        lowerBackgroundMusicVolume();

        // ìŒì„± íŒŒì¼ ë¡œë“œ ë° ì¬ìƒ
        voiceAudio.src = voiceFile;
        console.log(`ğŸ™ï¸ [DEBUG] ìŒì„± íŒŒì¼ src ì„¤ì • ì™„ë£Œ: ${voiceAudio.src}`);
        
        // ì•½ê°„ì˜ ì§€ì—° í›„ ì¬ìƒ ì‹œë„
        setTimeout(() => {
          voiceAudio.play().then(() => {
            isVoicePlaying = true;
            console.log(`ğŸ™ï¸ âœ… ìŒì„± ê°€ì´ë“œ ì¬ìƒ ì‹œì‘: ${pageName}`);
          }).catch(error => {
            console.error(`ğŸ™ï¸ âŒ ìŒì„± ê°€ì´ë“œ ì¬ìƒ ì‹¤íŒ¨: ${pageName}`, error);
            console.error(`ğŸ™ï¸ [ERROR] íŒŒì¼ ê²½ë¡œ: ${voiceFile}`);
            console.error(`ğŸ™ï¸ [ERROR] ìƒì„¸ ì˜¤ë¥˜:`, error.message);
            restoreBackgroundMusicVolume();
          });
        }, 100);
      }

      // ìŒì„± ê°€ì´ë“œ ì •ì§€
      function stopVoice() {
        if (voiceAudio) {
          voiceAudio.pause();
          voiceAudio.currentTime = 0;
          isVoicePlaying = false;
          restoreBackgroundMusicVolume();
          console.log('ğŸ™ï¸ ìŒì„± ê°€ì´ë“œ ì •ì§€');
        }
      }

      // ìŒì„± ê°€ì´ë“œ í† ê¸€
      function toggleVoiceGuide() {
        isVoiceEnabled = !isVoiceEnabled;
        if (!isVoiceEnabled && isVoicePlaying) {
          stopVoice();
        }
        console.log(`ğŸ™ï¸ ìŒì„± ê°€ì´ë“œ ${isVoiceEnabled ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}`);
        return isVoiceEnabled;
      }

      // ë°°ê²½ìŒì•… ë³¼ë¥¨ ì¤„ì´ê¸° (ìŒì„± ì¬ìƒ ì¤‘)
      function lowerBackgroundMusicVolume() {
        if (backgroundAudio && isMusicEnabled) {
          backgroundAudio.volume = 0.3; // 30%ë¡œ ì¤„ì„
          console.log('ğŸ”‰ ë°°ê²½ìŒì•… ë³¼ë¥¨ ê°ì†Œ (ìŒì„± ì¬ìƒ ì¤‘)');
        }
      }

      // ë°°ê²½ìŒì•… ë³¼ë¥¨ ë³µêµ¬
      function restoreBackgroundMusicVolume() {
        if (backgroundAudio && isMusicEnabled) {
          backgroundAudio.volume = 1.0; // ì›ë˜ ë³¼ë¥¨ìœ¼ë¡œ ë³µêµ¬
          console.log('ğŸ”Š ë°°ê²½ìŒì•… ë³¼ë¥¨ ë³µêµ¬');
        }
      }

      // ë°°ê²½ ìŒì•… í† ê¸€ í•¨ìˆ˜ (ì „ì—­ì—ì„œ ì‚¬ìš© ê°€ëŠ¥)
      function toggleBackgroundMusic() {
        if (isMusicEnabled) {
          // ìŒì•… ë„ê¸°
          backgroundAudio.pause();
          isMusicEnabled = false;
          console.log('ğŸ”‡ ë°°ê²½ ìŒì•… ë¹„í™œì„±í™”');
        } else {
          // ìŒì•… ì¼œê¸°
          isMusicEnabled = true;
          backgroundAudio.play().then(() => {
            console.log('ğŸµ ë°°ê²½ ìŒì•… í™œì„±í™”');
          }).catch(error => {
            console.warn('ë°°ê²½ ìŒì•… ì¬ìƒ ì‹¤íŒ¨:', error);
          });
        }
        return isMusicEnabled;
      }

      // í™ˆ ë™ì˜ìƒ ìƒíƒœì™€ ë°°ê²½ ìŒì•… ë™ê¸°í™” (ê°œì„ ëœ ë²„ì „)
      function syncMusicWithHomeVideo() {
        const homeVideo = document.getElementById('homeBackgroundVideo');
        if (!homeVideo) {
          console.warn('ğŸ”‡ í™ˆ ë™ì˜ìƒ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
          return isMusicEnabled;
        }

        console.log(`ğŸ”‡ [SYNC] í™ˆ ë™ì˜ìƒ ìŒì†Œê±° ìƒíƒœ: ${homeVideo.muted}`);
        console.log(`ğŸ”‡ [SYNC] í˜„ì¬ ë°°ê²½ìŒì•… ìƒíƒœ: ${isMusicEnabled}`);
        console.log(`ğŸ”‡ [SYNC] backgroundAudio ê°ì²´: ${!!backgroundAudio}`);
        
        // í™ˆ ë™ì˜ìƒì´ ìŒì†Œê±°ë˜ì–´ ìˆìœ¼ë©´ ë°°ê²½ ìŒì•…ê³¼ ìŒì„± ê°€ì´ë“œë„ ë„ê¸°
        if (homeVideo.muted) {
          // ë°°ê²½ ìŒì•… ë¹„í™œì„±í™”
          if (isMusicEnabled && backgroundAudio) {
            backgroundAudio.pause();
            isMusicEnabled = false;
            console.log('ğŸ”‡ í™ˆ ë™ì˜ìƒ ìŒì†Œê±°ì— ë”°ë¼ ë°°ê²½ ìŒì•… ë¹„í™œì„±í™”');
          }
          
          // ìŒì„± ê°€ì´ë“œë„ ë¹„í™œì„±í™”
          if (isVoiceEnabled) {
            isVoiceEnabled = false;
            if (isVoicePlaying && typeof stopVoice === 'function') {
              stopVoice();
            }
            console.log('ğŸ”‡ í™ˆ ë™ì˜ìƒ ìŒì†Œê±°ì— ë”°ë¼ ìŒì„± ê°€ì´ë“œ ë¹„í™œì„±í™”');
          }
        } else {
          // í™ˆ ë™ì˜ìƒ ì†Œë¦¬ê°€ ì¼œì ¸ ìˆìœ¼ë©´ ë°°ê²½ ìŒì•…ê³¼ ìŒì„± ê°€ì´ë“œë„ ì¼œê¸°
          if (!isMusicEnabled && backgroundAudio) {
            isMusicEnabled = true;
            
            // ë°°ê²½ìŒì•… ì¬ìƒ (ì•ˆì „í•œ ë¹„ë™ê¸° ì²˜ë¦¬)
            backgroundAudio.play().then(() => {
              console.log('ğŸ”Š í™ˆ ë™ì˜ìƒ ì¬ìƒì— ë”°ë¼ ë°°ê²½ ìŒì•… í™œì„±í™”');
            }).catch(error => {
              console.warn('ğŸ”Š ë°°ê²½ ìŒì•… ì¬ìƒ ì‹¤íŒ¨:', error);
              // ì‹¤íŒ¨í•´ë„ ìƒíƒœëŠ” ìœ ì§€
            });
          }
          
          // ìŒì„± ê°€ì´ë“œë„ í™œì„±í™”
          if (!isVoiceEnabled) {
            isVoiceEnabled = true;
            console.log('ğŸ”Š í™ˆ ë™ì˜ìƒ ì¬ìƒì— ë”°ë¼ ìŒì„± ê°€ì´ë“œ í™œì„±í™”');
          }
        }
        
        return isMusicEnabled;
      }

      // ì‚¬ìš©ì ìƒí˜¸ì‘ìš© í›„ ìë™ ìŒì•… ì‹œì‘
      function startBackgroundMusicOnInteraction() {
        // í™ˆ í™”ë©´ì—ì„œëŠ” í™ˆ ë™ì˜ìƒ ìƒíƒœì— ë”°ë¼ ê²°ì •
        const currentScreen = window.app?.getCurrentScreen?.() || 'home';
        
        if (currentScreen === 'home') {
          syncMusicWithHomeVideo();
        } else {
          // ë‹¤ë¥¸ í˜ì´ì§€ì—ì„œëŠ” í˜„ì¬ ìŒì•… í™œì„±í™” ìƒíƒœì— ë”°ë¼
          if (isMusicEnabled) {
            backgroundAudio.play().then(() => {
              console.log('ğŸµ ë°°ê²½ ìŒì•… ìë™ ì‹œì‘');
            }).catch(error => {
              console.warn('ë°°ê²½ ìŒì•… ì‹œì‘ ì‹¤íŒ¨:', error);
            });
          }
        }
      }

      // í™ˆ í™”ë©´ ë™ì˜ìƒ ì˜¤ë””ì˜¤ ìŒì†Œê±° í•¨ìˆ˜
      function muteHomeVideo() {
        setTimeout(() => {
          const homeVideo = document.getElementById('homeBackgroundVideo');
          if (homeVideo) {
            homeVideo.muted = true; // í™ˆ ë™ì˜ìƒ ìŒì†Œê±°
            homeVideo.volume = 0;
            console.log('ğŸ”‡ í™ˆ í™”ë©´ ë™ì˜ìƒ ì˜¤ë””ì˜¤ ìŒì†Œê±°');
            
            // ë°°ê²½ ìŒì•…ë„ í•¨ê»˜ ë¹„í™œì„±í™”
            syncMusicWithHomeVideo();
          }
        }, 1000);
      }

      window.updateFullscreenButton = function(isFullscreen) {
        const fullscreenBtn = document.getElementById('fullscreenToggle');
        if (!fullscreenBtn) return;
        
        if (isFullscreen) {
          fullscreenBtn.innerHTML = `
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M5 16H8V14H5V16ZM8 8H5V10H8V8ZM14 19H16V16H14V19ZM16 8V5H14V8H16ZM14 14H16V16H14V14ZM8 10H10V8H8V10ZM10 14V16H8V14H10ZM16 10H14V8H16V10Z" fill="currentColor"/>
            </svg>
          `;
          fullscreenBtn.title = 'ì „ì²´í™”ë©´ í•´ì œ';
        } else {
          fullscreenBtn.innerHTML = `
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M7 14H5V19H10V17H7V14Z" fill="currentColor"/>
              <path d="M5 10H7V7H10V5H5V10Z" fill="currentColor"/>
              <path d="M17 14H19V19H14V17H17V14Z" fill="currentColor"/>
              <path d="M14 5V7H17V10H19V5H14Z" fill="currentColor"/>
            </svg>
          `;
          fullscreenBtn.title = 'ì „ì²´í™”ë©´ ëª¨ë“œ';
        }
      };

      // ì „ì²´í™”ë©´ ìƒíƒœ ë³€ê²½ ê°ì§€
      window.handleFullscreenChange = function() {
        const isFullscreen = !!(document.fullscreenElement || document.webkitFullscreenElement);
        window.updateFullscreenButton(isFullscreen);
        
        if (isFullscreen) {
          document.body.classList.add('fullscreen-mode');
        } else {
          document.body.classList.remove('fullscreen-mode');
        }
      };

      // ì „ì²´í™”ë©´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
      document.addEventListener('fullscreenchange', window.handleFullscreenChange);
      document.addEventListener('webkitfullscreenchange', window.handleFullscreenChange);
      document.addEventListener('mozfullscreenchange', window.handleFullscreenChange);
      document.addEventListener('MSFullscreenChange', window.handleFullscreenChange);

      // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ ì¶”ê°€ ì„¤ì • (fullscreen-test.html ë°©ì‹)
      window.addEventListener('load', function() {
        console.log('ğŸ–¥ï¸ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ - ì „ì²´í™”ë©´ í•¨ìˆ˜ í™•ì¸');
        console.log('ğŸ–¥ï¸ window.toggleFullscreen:', typeof window.toggleFullscreen);
        
        // ì „ì²´í™”ë©´ ì§€ì› í™•ì¸
        const elem = document.documentElement;
        const support = elem.requestFullscreen ? 'Standard API âœ…' :
                       elem.webkitRequestFullscreen ? 'WebKit API âœ…' :
                       elem.mozRequestFullScreen ? 'Mozilla API âœ…' :
                       elem.msRequestFullscreen ? 'MS API âœ…' : 'Not Supported âŒ';
        console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ì§€ì›:', support);
      });
      
      // ì „ì²´í™”ë©´ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
      window.testFullscreen = function() {
        console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹œì‘');
        console.log('ğŸ–¥ï¸ ë¸Œë¼ìš°ì € ì§€ì› ì—¬ë¶€:', {
          requestFullscreen: !!document.documentElement.requestFullscreen,
          webkitRequestFullscreen: !!document.documentElement.webkitRequestFullscreen,
          mozRequestFullScreen: !!document.documentElement.mozRequestFullScreen,
          msRequestFullscreen: !!document.documentElement.msRequestFullscreen
        });
        
        const fullscreenBtn = document.getElementById('fullscreenToggle');
        console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ë²„íŠ¼ ì¡´ì¬:', !!fullscreenBtn);
        
        if (fullscreenBtn) {
          console.log('ğŸ–¥ï¸ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ìˆ˜ë™ ë°œìƒ');
          fullscreenBtn.click();
        }
      };

      // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ ìë™ ì´ˆê¸°í™” ë° ì¬ìƒ
      window.addEventListener('load', () => {
        console.log('ğŸ¬ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ - ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹œì‘');
        
        initBackgroundMusic();
        initVoiceGuide(); // ìŒì„± ê°€ì´ë“œ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
        muteHomeVideo(); // í™ˆ ë™ì˜ìƒ ìŒì†Œê±°
        
        // ì „ì²´í™”ë©´ ë²„íŠ¼ ì´ˆê¸° ìƒíƒœ ì„¤ì •
        updateFullscreenButton(false);
        
        // ğŸ–¥ï¸ í‚¤ì˜¤ìŠ¤í¬ ëª¨ë“œ: ê¸°ë³¸ ì „ì²´í™”ë©´ ì„¤ì •
        initKioskMode();
        
        // ğŸ–¥ï¸ ì „ì²´í™”ë©´ ë²„íŠ¼ í™•ì¸ (í™ˆ í™”ë©´ ë¡œë“œ í›„)
        setTimeout(() => {
          const fullscreenBtn = document.getElementById('fullscreenToggle');
          console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ë²„íŠ¼ ì¡´ì¬ ì—¬ë¶€:', !!fullscreenBtn);
          console.log('ğŸ–¥ï¸ window.toggleFullscreen í•¨ìˆ˜:', typeof window.toggleFullscreen);
          
          if (fullscreenBtn) {
            console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ë²„íŠ¼ onclick ì†ì„±:', fullscreenBtn.getAttribute('onclick'));
            
            // ìˆ˜ë™ìœ¼ë¡œ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            fullscreenBtn.addEventListener('click', function(e) {
              console.log('ğŸ–¥ï¸ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ê°ì§€ë¨!');
              e.preventDefault();
              if (typeof window.toggleFullscreen === 'function') {
                window.toggleFullscreen();
              } else {
                console.error('ğŸ–¥ï¸ toggleFullscreen í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
              }
            });
            console.log('ğŸ–¥ï¸ âœ… ì „ì²´í™”ë©´ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ ì™„ë£Œ');
          } else {
            console.error('ğŸ–¥ï¸ âŒ ì „ì²´í™”ë©´ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ');
          }
        }, 2000); // í™ˆ í™”ë©´ ë¡œë“œ í›„ 2ì´ˆ ëŒ€ê¸°            // ì‚¬ìš©ì ìƒí˜¸ì‘ìš© ê°ì§€ (ë²„íŠ¼ í´ë¦­, í„°ì¹˜, í‚¤ë³´ë“œ ë“±)
            const interactionEvents = ['click', 'touchstart', 'keydown'];
            
            function markUserInteraction() {
              if (!userHasInteracted) {
                userHasInteracted = true;
                console.log('ğŸ‘† ì‚¬ìš©ì ìƒí˜¸ì‘ìš© ê°ì§€ë¨ - ìŒì„± ì¬ìƒ ê°€ëŠ¥');
              }
            }
            
            // ìƒí˜¸ì‘ìš© ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
            interactionEvents.forEach(event => {
              document.addEventListener(event, markUserInteraction, { once: true });
            });        // ì²« ë²ˆì§¸ í´ë¦­ì´ë‚˜ í„°ì¹˜ì—ì„œ ìŒì•… ìë™ ì‹œì‘
        document.addEventListener('click', startBackgroundMusicOnInteraction, { once: true });
        document.addEventListener('touchstart', startBackgroundMusicOnInteraction, { once: true });
      });

      // ğŸ–¥ï¸ í‚¤ì˜¤ìŠ¤í¬ ëª¨ë“œ ì´ˆê¸°í™” (ë§¥ë¶ í¬ë¡¬ í˜¸í™˜ ë²„ì „)
      function initKioskMode() {
        console.log('ğŸ–¥ï¸ í‚¤ì˜¤ìŠ¤í¬ ëª¨ë“œ ì´ˆê¸°í™” ì‹œì‘ (ì•ˆì „ ëª¨ë“œ)');
        
        // ì „ì²´í™”ë©´ ì§€ì› ì—¬ë¶€ í™•ì¸
        const elem = document.documentElement;
        const fullscreenSupported = !!(elem.requestFullscreen || 
                                      elem.webkitRequestFullscreen || 
                                      elem.mozRequestFullScreen || 
                                      elem.msRequestFullscreen);
        
        console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ì§€ì›:', fullscreenSupported);
        
        if (!fullscreenSupported) {
          console.warn('ğŸ–¥ï¸ âš ï¸ ì´ ë¸Œë¼ìš°ì €ëŠ” ì „ì²´í™”ë©´ APIë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤');
          // ì „ì²´í™”ë©´ ë²„íŠ¼ ë¹„í™œì„±í™”
          const fullscreenBtn = document.getElementById('fullscreenToggle');
          if (fullscreenBtn) {
            fullscreenBtn.style.opacity = '0.5';
            fullscreenBtn.style.cursor = 'not-allowed';
            fullscreenBtn.title = 'ì „ì²´í™”ë©´ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤';
          }
        }
        
        // í™”ë©´ íšŒì „ ì ê¸ˆ (ëª¨ë°”ì¼ì—ì„œë§Œ)
        if (window.innerWidth <= 1024 && screen.orientation && screen.orientation.lock) {
          screen.orientation.lock('landscape').catch(err => {
            console.log('ğŸ”„ í™”ë©´ íšŒì „ ì ê¸ˆ ì‹¤íŒ¨ (ê¶Œí•œ í•„ìš”):', err);
          });
        }
        
        // ë”ë¸”íƒ­ ì¤Œ ë°©ì§€ (ëª¨ë°”ì¼ì—ì„œë§Œ)
        if (window.innerWidth <= 1024) {
          let lastTouchEnd = 0;
          document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
              event.preventDefault();
            }
            lastTouchEnd = now;
          }, false);
        }
        
        // F11í‚¤ë¡œ ì „ì²´í™”ë©´ í† ê¸€ (ë°ìŠ¤í¬í†±ì—ì„œë§Œ)
        if (window.innerWidth > 1024) {
          document.addEventListener('keydown', function(e) {
            if (e.key === 'F11') {
              e.preventDefault();
              toggleFullscreen();
            }
          });
        }
        
        console.log('ğŸ–¥ï¸ í‚¤ì˜¤ìŠ¤í¬ ëª¨ë“œ ì„¤ì • ì™„ë£Œ (ì•ˆì „ ëª¨ë“œ)');
      }

      // ì „ì²´í™”ë©´ ìš”ì²­ (ê°„ì†Œí™”ëœ ë²„ì „)
      function requestFullscreenMode() {
        if (!document.fullscreenElement) {
          const elem = document.documentElement;
          
          console.log('ğŸ–¥ï¸ ì „ì²´í™”ë©´ ëª¨ë“œ ìš”ì²­ ì‹œì‘...');
          
          if (elem.requestFullscreen) {
            elem.requestFullscreen().then(() => {
              console.log('ğŸ–¥ï¸ âœ… ì „ì²´í™”ë©´ ëª¨ë“œ í™œì„±í™”');
            }).catch(err => {
              console.log('ğŸ–¥ï¸ âŒ ì „ì²´í™”ë©´ ìš”ì²­ ì‹¤íŒ¨:', err);
            });
          } else if (elem.webkitRequestFullscreen) { // Safari
            elem.webkitRequestFullscreen();
          } else if (elem.msRequestFullscreen) { // IE/Edge
            elem.msRequestFullscreen();
          } else if (elem.mozRequestFullScreen) { // Firefox
            elem.mozRequestFullScreen();
          }
        }
      }
      
      // 5ì´ˆ í›„ ë™ì˜ìƒ ìƒíƒœ í™•ì¸
      setTimeout(() => {
        const video = document.getElementById('homeBackgroundVideo');
        console.log('ğŸ¬ ë™ì˜ìƒ ìš”ì†Œ:', video);
        if (video) {
          console.log('ğŸ¬ ë™ì˜ìƒ src:', video.src);
          console.log('ğŸ¬ ë™ì˜ìƒ readyState:', video.readyState);
          console.log('ğŸ¬ ë™ì˜ìƒ networkState:', video.networkState);
        }
        
        const videoContainer = document.querySelector('.home-video-container');
        console.log('ğŸ¬ ë™ì˜ìƒ ì»¨í…Œì´ë„ˆ:', videoContainer);
        
        // ë°°ê²½ ìŒì•… ìƒíƒœ í™•ì¸
        console.log('ğŸµ ë°°ê²½ ìŒì•… ìƒíƒœ:', {
          currentTrack: currentAudioIndex,
          volume: backgroundAudio?.volume,
          src: backgroundAudio?.src
        });
      }, 5000);
    </script>
  </body>
</html>
